# Vue

## ä»‹ç»

`Vue` æ˜¯ä¸€æ¬¾ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ ***æ¸è¿›å¼*** `JavaScript` æ¡†æ¶ã€‚å®ƒåŸºäºæ ‡å‡† `HTML` `CSS` å’Œ `JavaScript` æ„å»ºï¼Œå¹¶æä¾›äº†ä¸€å¥— ***å£°æ˜å¼*** çš„ã€***ç»„ä»¶åŒ–*** çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå¸®åŠ©ä½ é«˜æ•ˆåœ°å¼€å‘ç”¨æˆ·ç•Œé¢ã€‚

::: tip å£°æ˜

`Vue` æœ‰æå…¶å®Œå¤‡çš„æ–‡æ¡£ï¼šhttps://cn.vuejs.org/

æ ¹æ®æ–‡æ¡£å¯ä»¥å¿«é€Ÿä¸Šæ‰‹ï¼Œè§£å†³é—®é¢˜ï¼Œé›†æˆç”Ÿæ€ã€‚

æœ¬æ–‡æ¡£ä»…ä»ä¸ªäººè§’åº¦ä»‹ç» `Vue` çš„å¸¸è§åº”ç”¨ä¸é—®é¢˜, æ–‡æ¡£demoä»“åº“ï¼šhttps://github.com/chenrui1996/vue-demoã€‚

ï¼Œè¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒå®˜ç½‘ã€‚

:::

::: warning æ¸è¿›å¼æ¡†æ¶
`Vue` æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç”Ÿæ€ã€‚å…¶åŠŸèƒ½è¦†ç›–äº†å¤§éƒ¨åˆ†å‰ç«¯å¼€å‘å¸¸è§çš„éœ€æ±‚ã€‚

ä½† Web ä¸–ç•Œæ˜¯ååˆ†å¤šæ ·åŒ–çš„ï¼Œä¸åŒçš„å¼€å‘è€…åœ¨ Web ä¸Šæ„å»ºçš„ä¸œè¥¿å¯èƒ½åœ¨å½¢å¼å’Œè§„æ¨¡ä¸Šä¼šæœ‰å¾ˆå¤§çš„ä¸åŒã€‚

è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼ŒVue çš„è®¾è®¡éå¸¸æ³¨é‡çµæ´»æ€§å’Œâ€œå¯ä»¥è¢«é€æ­¥é›†æˆâ€è¿™ä¸ªç‰¹ç‚¹ã€‚

æ ¹æ®ä½ çš„éœ€æ±‚åœºæ™¯ï¼Œä½ å¯ä»¥ç”¨ä¸åŒçš„æ–¹å¼ä½¿ç”¨ `Vue`ï¼š

- æ— éœ€æ„å»ºæ­¥éª¤ï¼Œæ¸è¿›å¼å¢å¼º**é™æ€**çš„ `HTML`.
- åœ¨ä»»ä½•é¡µé¢ä¸­ä½œä¸º `Web Components` åµŒå…¥
- **å•é¡µåº”ç”¨ (SPA)**
- **å…¨æ ˆ / æœåŠ¡ç«¯æ¸²æŸ“ (SSR)**
- **Jamstack / é™æ€ç«™ç‚¹ç”Ÿæˆ (SSG)**
- **å¼€å‘æ¡Œé¢ç«¯ã€ç§»åŠ¨ç«¯ã€WebGLï¼Œç”šè‡³æ˜¯å‘½ä»¤è¡Œç»ˆç«¯ä¸­çš„ç•Œé¢**
:::

::: warning å¸¸è§å‰ç«¯æ¸²æŸ“æ–¹å¼
| æ¸²æŸ“æ–¹å¼            | ç®€ä»‹                                                           | åº”ç”¨åœºæ™¯ç¤ºä¾‹                                                             |
| ------------------- | -------------------------------------------------------------- | ------------------------------------------------------------------------ |
| SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰   | é¡µé¢ HTML åœ¨æœåŠ¡å™¨ç”Ÿæˆï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°å®Œæ•´ HTML å†æ˜¾ç¤º           | Razor Pagesã€Blazor Server                                               |
| CSRï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰   | åç«¯ä»…è¿”å›æ•°æ®ï¼Œé¡µé¢ç»“æ„å’Œæ¸²æŸ“é€»è¾‘åœ¨æµè§ˆå™¨ä¸­ç”± JavaScript æ‰§è¡Œ | Vue/React SPA                                                            |
| SSGï¼ˆé™æ€ç«™ç‚¹ç”Ÿæˆï¼‰ | ç¼–è¯‘æ—¶ç”Ÿæˆé™æ€ HTMLï¼Œéƒ¨ç½²æ—¶ç›´æ¥æä¾›                            | [Nuxt é™æ€æ¨¡å¼](https://nuxt.com/)ã€[Jekyll](https://www.jekyll.com.cn/) |
| ISRï¼ˆå¢é‡é™æ€ç”Ÿæˆï¼‰ | é™æ€é¡µé¢æ”¯æŒæŒ‰éœ€é‡æ–°ç”Ÿæˆï¼Œç»“åˆ SSG ä¸ SSR çš„ä¼˜ç‚¹               | [Next.js](https://nextjs.org/) ISR æ¨¡å¼                                  |
| æ··åˆæ¸²æŸ“ï¼ˆHybridï¼‰  | æŸäº›é¡µé¢ SSRï¼ŒæŸäº›é¡µé¢ CSRï¼Œç»“åˆä½¿ç”¨                           | [Nuxt](https://nuxt.com/)ã€[Next.js](https://nextjs.org/) æ”¯æŒæŒ‰è·¯ç”±é…ç½® |
| Prerenderï¼ˆé¢„æ¸²æŸ“ï¼‰ | æ„å»ºé˜¶æ®µé¢„å…ˆæ‰§è¡Œ JSï¼Œç”Ÿæˆ HTML å¿«ç…§                            | Vue Prerender æ’ä»¶                                                       |

:::

::: danger vue2 ä¸ vue3
1. Vue 2 å·²åœ¨ 2023 å¹´ 12 æœˆ 31 æ—¥åˆ°è¾¾å®ƒçš„æˆªæ­¢ç»´æŠ¤æ—¥æœŸã€‚åœ¨æ­¤ä¹‹åï¼ŒVue 2 åœ¨å·²æœ‰çš„åˆ†å‘æ¸ é“ (å„ç±» CDN å’ŒåŒ…ç®¡ç†å™¨) ä¸­ä»ç„¶å¯ç”¨ï¼Œ**ä½†ä¸å†è¿›è¡Œæ›´æ–°ï¼ŒåŒ…æ‹¬å¯¹å®‰å…¨é—®é¢˜å’Œæµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜çš„ä¿®å¤ç­‰ã€‚**
2. å¤§éƒ¨åˆ† Vue 3 é‡è¦çš„ç‰¹æ€§ç§»æ¤å›äº† Vue 2.7ï¼ŒåŒ…æ‹¬ç»„åˆå¼ API å’Œ `<script setup>`ã€‚å¦‚æœæ‰“ç®—ç•™åœ¨ Vue 2ï¼Œåº”è¯¥è‡³å°‘å‡çº§è‡³ 2.7ã€‚
3. Vue 2 å‡çº§åˆ°vue3å‚è€ƒ [vue3è¿ç§»æŒ‡å—](https://v3-migration.vuejs.org/zh/breaking-changes/key-attribute.html)
4. Vue 3 æä¾›äº†æ›´å°çš„åŒ…ä½“ç§¯ã€æ›´å¥½çš„æ€§èƒ½ã€æ›´å¥½çš„å¯æ‰©å±•æ€§å’Œæ›´å¥½çš„ TypeScript/IDE æ”¯æŒã€‚ä½†Vue 3 ç”¨åˆ°äº†ä¸€äº› IE11 ä¸æ”¯æŒçš„ç°ä»£ JavaScript ç‰¹æ€§ã€‚
5. vue 3 ç›¸å¯¹vue 2çš„ä¼˜åŒ–
   1. Vue 3 é‡å†™äº†è™šæ‹Ÿ DOMï¼Œä½¿å…¶æ›´å¿«ã€æ›´è½»é‡ï¼Œå†…å­˜å ç”¨æ›´ä½ã€‚Patch è¿‡ç¨‹æ›´é«˜æ•ˆï¼Œdiff ç®—æ³•æ›´æ™ºèƒ½ã€‚
   2. Vue 3 ä½¿ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œæ”¯æŒ `Tree-shaking`ï¼Œæ‰“åŒ…æ—¶å¯ä»¥å‰”é™¤æœªä½¿ç”¨çš„åŠŸèƒ½ï¼Œå‡å°ä½“ç§¯ã€‚
   3. æ ¸å¿ƒåº“æ¯” Vue 2 æ›´è½»é‡ï¼ˆå‹ç¼©åçº¦ 10KB å·¦å³ï¼Œæ¯” Vue 2 å°çº¦ 50%ï¼‰ã€‚
   4. ç¼–è¯‘å™¨èƒ½æ›´å¥½åœ°æ ‡è®°é™æ€èŠ‚ç‚¹ï¼Œå‡å°‘è¿è¡Œæ—¶å¼€é”€ã€‚
   5. Vue 3 ä½¿ç”¨ `Proxy` ä»£æ›¿ vue 2ä¸­çš„ `Object.defineProperty`ï¼ˆæ— æ³•ç›‘å¬æ•°ç»„ç´¢å¼•ã€æ–°å¢å±æ€§ç­‰ï¼‰ å®ç°å“åº”å¼ï¼Œèƒ½ç›‘å¬å‡ ä¹æ‰€æœ‰æ“ä½œï¼ŒåŒ…æ‹¬æ–°å¢ã€åˆ é™¤ã€åµŒå¥—å±æ€§å˜æ›´ç­‰ã€‚
   6. `Composition API` æ›¿ä»£ `Options API` çš„å±€é™æ€§ã€‚
   7. Vue 3 é‡å†™ä»£ç ä¸º TypeScriptï¼ŒåŸç”Ÿæ”¯æŒï¼Œå¼€å‘ä½“éªŒæ›´å¥½ã€‚
   8. ref, `reactive`, `computed`, `watch`, `watchEffect` ç­‰æ–°çš„å“åº”å¼å·¥å…·å‡½æ•°ã€‚`provide` / `inject` æ›´é€‚åˆé€»è¾‘å¤ç”¨ã€‚
:::

## åˆ›å»ºåº”ç”¨

### å‡†å¤‡å·¥ä½œ

::: warning node.js
[Node.js](https://nodejs.org/zh-cn) æ˜¯ä¸€ä¸ªå…è´¹ã€å¼€æºã€è·¨å¹³å°çš„ `JavaScript` è¿è¡Œæ—¶ç¯å¢ƒ, 

å®ƒå…è®¸å¼€å‘è€…åœ¨**æœåŠ¡å™¨ç«¯**ä½¿ç”¨ `JavaScript` ç¼–å†™åº”ç”¨ç¨‹åºï¼Œä»è€Œå®ç°å‰åç«¯ç»Ÿä¸€çš„å¼€å‘è¯­è¨€ã€‚

---

- **æ ¸å¿ƒç‰¹ç‚¹**
  - äº‹ä»¶é©±åŠ¨ä¸éé˜»å¡ I/Oï¼šNode.js é‡‡ç”¨å•çº¿ç¨‹æ¶æ„ï¼Œç»“åˆäº‹ä»¶å¾ªç¯æœºåˆ¶å’Œå¼‚æ­¥ I/O æ“ä½œï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å¤§é‡å¹¶å‘è¿æ¥ï¼Œé€‚ç”¨äº I/O å¯†é›†å‹åº”ç”¨ï¼Œå¦‚ Web æœåŠ¡å™¨å’Œå®æ—¶é€šä¿¡å·¥å…·ã€‚ 
  - é«˜æ€§èƒ½ï¼šå¾—ç›Šäº V8 å¼•æ“çš„ä¼˜åŒ–ï¼ŒNode.js åœ¨æ‰§è¡Œ JavaScript ä»£ç æ—¶è¡¨ç°å‡ºè‰²ï¼Œé€‚åˆæ„å»ºé«˜æ€§èƒ½çš„ç½‘ç»œåº”ç”¨ã€‚
  - ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿï¼šé€šè¿‡å†…ç½®çš„ npmï¼ˆNode Package Managerï¼‰ï¼Œå¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°å®‰è£…å’Œç®¡ç†ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ŒåŠ é€Ÿå¼€å‘æµç¨‹ã€‚ 
  - è·¨å¹³å°æ”¯æŒï¼šNode.js å¯åœ¨ Windowsã€Linux å’Œ macOS ç­‰å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œé€‚åº”å¤šæ ·åŒ–çš„éƒ¨ç½²éœ€æ±‚ã€‚

---

- **`Vue` ä¸­ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ `node.js`**

  **1. å¼€å‘å·¥å…·é“¾ä¾èµ– Node.js**
    - Vue CLI / Viteï¼šå®˜æ–¹è„šæ‰‹æ¶å·¥å…·ï¼ˆå¦‚ Vue CLI æˆ– Viteï¼‰éœ€è¦ Node.js ç¯å¢ƒæ¥åˆå§‹åŒ–é¡¹ç›®ã€ç®¡ç†ä¾èµ–å’Œè¿è¡Œå¼€å‘æœåŠ¡å™¨ã€‚
    - çƒ­é‡è½½ï¼ˆHMRï¼‰ï¼šå¼€å‘æ—¶çš„æ¨¡å—çƒ­æ›´æ–°ä¾èµ– Node.js æä¾›çš„æœ¬åœ°æœåŠ¡å™¨èƒ½åŠ›ã€‚
    - æ„å»ºå·¥å…·ï¼šwebpackã€Rollup æˆ– Vite ç­‰å·¥å…·éœ€è¦ Node.js æ‰§è¡Œä»£ç æ‰“åŒ…ã€å‹ç¼©ã€è½¬è¯‘ç­‰æ“ä½œ

  **2. npm/yarn/pnpm åŒ…ç®¡ç†**
     - Vue ç”Ÿæ€ç³»ç»Ÿçš„å¤§é‡ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ vue-routerã€piniaã€axiosï¼‰é€šè¿‡ npm/yarn å®‰è£…ï¼Œè¿™äº›å·¥å…·åŸºäº Node.jsã€‚

  **3. å‰ç«¯å·¥ç¨‹åŒ–éœ€æ±‚**
     - æ¨¡å—åŒ–å¼€å‘ï¼šNode.js æ”¯æŒ ES Modules/CommonJSï¼Œæ–¹ä¾¿ç»„ç»‡ç°ä»£å‰ç«¯ä»£ç ã€‚
     - ç¼–è¯‘è½¬æ¢ï¼šVue å•æ–‡ä»¶ç»„ä»¶ï¼ˆ.vueï¼‰éœ€è¦ vue-loader æˆ– @vitejs/plugin-vue è½¬è¯‘ä¸ºæµè§ˆå™¨å¯æ‰§è¡Œçš„ JSï¼Œè¿™éœ€è¦ Node.js ç¯å¢ƒã€‚
     - é¢„å¤„ç†è¯­è¨€ï¼šSass/Less/TypeScript ç­‰éœ€é€šè¿‡ Node.js å·¥å…·é“¾ç¼–è¯‘ã€‚

  **4. æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰**
     - ä½¿ç”¨ Nuxt.js æˆ–ç›´æ¥é…ç½® Vue SSR æ—¶ï¼Œéœ€è¦ Node.js ä½œä¸ºæœåŠ¡å™¨æ¸²æŸ“ Vue ç»„ä»¶å¹¶è¿”å› HTMLï¼Œæå‡é¦–å±æ€§èƒ½å’Œ SEOã€‚

  **5. API ä»£ç†ä¸ Mock æ•°æ®**
     - å¼€å‘æ—¶å¯é€šè¿‡ Node.js æœåŠ¡å™¨ä»£ç† API è¯·æ±‚ï¼Œè§£å†³è·¨åŸŸé—®é¢˜ï¼ˆå¦‚ vite.config.js ä¸­çš„ proxy é…ç½®ï¼‰ã€‚
     - ä½¿ç”¨ Mock.js ç­‰å·¥å…·æ¨¡æ‹Ÿåç«¯æ¥å£ã€‚

  **6. è‡ªåŠ¨åŒ–ä¸è„šæœ¬**
     - é€šè¿‡ Node.js ç¼–å†™è„šæœ¬å¤„ç†é‡å¤ä»»åŠ¡ï¼ˆå¦‚æ‰¹é‡ç”Ÿæˆç»„ä»¶ã€éƒ¨ç½²å‰ä¼˜åŒ–ç­‰ï¼‰ã€‚
---

- **å¯ä¸å¯ä»¥ä¸ç”¨ Node.js**
  - ç›´æ¥å¼•å…¥ï¼šç›´æ¥ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼Œé€šè¿‡ `<script>` æ ‡ç­¾å¼•å…¥ `Vue`ï¼Œæˆ–ç›´æ¥å¼•å…¥ `CDN`ï¼Œ é€‚åˆç®€å•é¡µé¢æˆ–å­¦ä¹ ï¼Œä½†æ— æ³•äº«å—å·¥ç¨‹åŒ–ä¼˜åŠ¿ã€‚
  - é™æ€ç”Ÿæˆï¼šä½¿ç”¨ Vue æ„å»ºçº¯é™æ€ç«™ç‚¹ï¼ˆå¦‚é€šè¿‡ vitepressï¼‰åï¼Œç”Ÿäº§ç¯å¢ƒåªéœ€é™æ€æœåŠ¡å™¨ï¼ˆå¦‚ Nginxï¼‰ã€‚

---


:::

::: tip webpack
[Webpack](https://webpack.js.org/) æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å‰ç«¯æ„å»ºå·¥å…·å’Œæ¨¡å—æ‰“åŒ…å™¨ï¼Œå¹¿æ³›åº”ç”¨äºç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„å¼€å‘ä¸­ã€‚

å®ƒèƒ½å¤Ÿå°†é¡¹ç›®ä¸­çš„å„ç§èµ„æºï¼ˆå¦‚ JavaScriptã€CSSã€å›¾ç‰‡ç­‰ï¼‰è§†ä¸ºæ¨¡å—ï¼Œæ„å»ºå‡ºæ¸…æ™°çš„ä¾èµ–å…³ç³»å›¾ï¼Œå¹¶å°†è¿™äº›æ¨¡å—æ‰“åŒ…æˆå¯ä¾›æµè§ˆå™¨ä½¿ç”¨çš„é™æ€æ–‡ä»¶ã€‚

---

- æ ¸å¿ƒæ¦‚å¿µ

  1. å…¥å£ï¼ˆEntryï¼‰

  å…¥å£æŒ‡ç¤º Webpack åº”è¯¥ä»å“ªä¸ªæ¨¡å—å¼€å§‹æ„å»ºä¾èµ–å›¾ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebpack ä¼šä» `./src/index.js` ä½œä¸ºå…¥å£ã€‚

  ```javascript
  module.exports = {
    entry: './src/index.js',
  };
  ```

  å¯¹äºå¤šé¡µé¢åº”ç”¨ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªå…¥å£ç‚¹ã€‚

  2. è¾“å‡ºï¼ˆOutputï¼‰

  è¾“å‡ºé…ç½®å‘Šè¯‰ Webpack å¦‚ä½•å‘½åå’Œå­˜å‚¨æ‰“åŒ…åçš„æ–‡ä»¶ã€‚

  ```javascript
  module.exports = {
    output: {
      filename: 'bundle.js',
      path: path.resolve(__dirname, 'dist'),
    },
  };
  ```

  `filename` æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ï¼Œ`path` æŒ‡å®šè¾“å‡ºç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚

  3. åŠ è½½å™¨ï¼ˆLoadersï¼‰

  åŠ è½½å™¨ä½¿ Webpack èƒ½å¤Ÿå¤„ç†é JavaScript æ–‡ä»¶ï¼Œå¦‚ CSSã€å›¾ç‰‡ç­‰ã€‚å®ƒä»¬åœ¨æ¨¡å—åŠ è½½æ—¶è¿›è¡Œè½¬æ¢ï¼Œä½¿è¿™äº›èµ„æºèƒ½å¤Ÿè¢«æ·»åŠ åˆ°ä¾èµ–å›¾ä¸­ã€‚

  ```javascript
  module.exports = {
    module: {
      rules: [
        {
          test: /\.css$/,
          use: ['style-loader', 'css-loader'],
        },
      ],
    },
  };
  ```

  ä¸Šè¿°é…ç½®å…è®¸ Webpack å¤„ç† `.css` æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ° JavaScript ä¸­ã€‚

  4. æ’ä»¶ï¼ˆPluginsï¼‰

  æ’ä»¶ç”¨äºæ‰§è¡ŒèŒƒå›´æ›´å¹¿çš„ä»»åŠ¡ï¼Œå¦‚æ‰“åŒ…ä¼˜åŒ–ã€èµ„æºç®¡ç†ã€ç¯å¢ƒå˜é‡æ³¨å…¥ç­‰ã€‚

  ```javascript
  const HtmlWebpackPlugin = require('html-webpack-plugin');

  module.exports = {
    plugins: [
      new HtmlWebpackPlugin({ template: './src/index.html' }),
    ],
  };
  ```
  `HtmlWebpackPlugin` æ’ä»¶ä¼šæ ¹æ®æä¾›çš„æ¨¡æ¿ç”Ÿæˆä¸€ä¸ª HTML æ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨å¼•å…¥æ‰“åŒ…åçš„èµ„æºã€‚

  5. æ¨¡å¼ï¼ˆModeï¼‰

  Webpack æä¾›äº†ä¸‰ç§æ¨¡å¼ï¼š`development`ã€`production` å’Œ `none`ã€‚è®¾ç½®ä¸åŒçš„æ¨¡å¼ä¼šå¯ç”¨ç›¸åº”çš„ä¼˜åŒ–ã€‚

  ```javascript
  module.exports = {
    mode: 'development', // æˆ– 'production'ã€'none'
  };
  ```

  * `development`ï¼šå¯ç”¨æœ‰åˆ©äºå¼€å‘çš„è®¾ç½®ï¼Œå¦‚æœªå‹ç¼©çš„è¾“å‡ºå’Œè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ã€‚
  * `production`ï¼šå¯ç”¨ä¼˜åŒ–è®¾ç½®ï¼Œå¦‚ä»£ç å‹ç¼©å’Œæ€§èƒ½æå‡ã€‚

---
:::

::: tip Vue CLIï¼ˆåŸºäº Webpackï¼‰
Vue CLIï¼ˆCommand Line Interfaceï¼‰æ˜¯ Vue.js å®˜æ–¹æä¾›çš„è„šæ‰‹æ¶å·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…å¿«é€Ÿæ­å»ºå’Œç®¡ç† Vue é¡¹ç›®ã€‚

> Vue CLI ç°å·²å¤„äºç»´æŠ¤æ¨¡å¼!
> ç°åœ¨å®˜æ–¹æ¨èä½¿ç”¨ create-vue æ¥åˆ›å»ºåŸºäº Vite çš„æ–°é¡¹ç›®ã€‚ å¦å¤–è¯·å‚è€ƒ Vue 3 å·¥å…·é“¾æŒ‡å— ä»¥äº†è§£æœ€æ–°çš„å·¥å…·æ¨èã€‚

[å®˜ç½‘](https://cli.vuejs.org/zh/)

:::

::: warning Vite
Vite æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„å‰ç«¯æ„å»ºå·¥å…·ï¼Œäº 2020 å¹´å‘å¸ƒï¼Œæ—¨åœ¨é€šè¿‡åˆ©ç”¨ç°ä»£æµè§ˆå™¨çš„åŸç”Ÿ ES æ¨¡å—æ”¯æŒï¼Œæä¾›å¿«é€Ÿçš„å¼€å‘ä½“éªŒã€‚

[å®˜ç½‘](https://cn.vite.dev/), [ä¸ºä»€ä¹ˆé€‰ Vite](https://cn.vite.dev/guide/why.html)

:::

### åˆ›å»ºä¸€ä¸ª Vue åº”ç”¨

[å®˜ç½‘æ–‡æ¡£](https://cn.vuejs.org/guide/quick-start)

- **éœ€è¦å®‰è£… Node.js**

> **è‹¥æœ¬åœ°éœ€è¦å¤šä¸ªç‰ˆæœ¬çš„Node.jsï¼Œå¯ä»¥ä½¿ç”¨ [NVM](https://github.com/coreybutler/nvm-windows) ç®¡ç†**

**Vue å’Œ Node.js ç‰ˆæœ¬**

| Vue ç‰ˆæœ¬ | æ¨è Node.js ç‰ˆæœ¬ | æ„å»ºå·¥å…·å»ºè®®        | ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ |
| -------- | ----------------- | ------------------- | ------------ |
| Vue 2.x  | 10 â€“ 16           | Vue CLI 4.x         | å·²åœæ­¢ç»´æŠ¤   |
| Vue 3.x  | 18.3 åŠä»¥ä¸Š       | Vite / Vue CLI 4.5+ | æ´»è·ƒç»´æŠ¤ä¸­   |

- **éœ€è¦å®‰è£… `create-vue`(é»˜è®¤é›†æˆäº† `Vite` ä½œä¸ºæ„å»ºå·¥å…·çš„ `Vue` å®˜æ–¹æä¾›çš„è„šæ‰‹æ¶å·¥å…·)**
 
> **å¦‚æœªå®‰è£…å»ºè®®å…¨å±€å®‰è£…`npm install -g  create-vue@latest`**

---

#### åˆ›å»ºæ­¥éª¤

1. **è¿è¡Œä»¥ä¸‹å‘½ä»¤**
``` sh
npm create vue@latest
```

  **å¯é€‰åŠŸèƒ½æç¤ºï¼š**

``` sh
â—‡  è¯·è¾“å…¥é¡¹ç›®åç§°ï¼š
â”‚  vue-demo
â”‚
â—†  è¯·é€‰æ‹©è¦åŒ…å«çš„åŠŸèƒ½ï¼š (â†‘/â†“ åˆ‡æ¢ï¼Œç©ºæ ¼é€‰æ‹©ï¼Œa å…¨é€‰ï¼Œå›è½¦ç¡®è®¤)
â”‚  â—» TypeScript
â”‚  â—» JSX æ”¯æŒ
â”‚  â—» Routerï¼ˆå•é¡µé¢åº”ç”¨å¼€å‘ï¼‰
â”‚  â—» Piniaï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
â”‚  â—» Vitestï¼ˆå•å…ƒæµ‹è¯•ï¼‰
â”‚  â—» ç«¯åˆ°ç«¯æµ‹è¯•
â”‚  â—» ESLintï¼ˆé”™è¯¯é¢„é˜²ï¼‰
â”‚  â—» Prettierï¼ˆä»£ç æ ¼å¼åŒ–ï¼‰
```

2. **å®‰è£…ä¾èµ–**
``` sh
cd <your-project-name>
npm install
```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
``` sh
cd <your-project-name>
npm run dev
```

4. **å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒ**

``` sh
npm run build
```

---

#### ç›®å½•ç»“æ„åˆ†æ

```bash
my-vue-app/
â”œâ”€â”€ node_modules/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ App.vue
â”‚   â””â”€â”€ main.js
â”œâ”€â”€ .gitignore
â”œâ”€â”€ babel.config.js
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â””â”€â”€ vue.config.js (å¯é€‰)
```

1. **`node_modules/`**

* è‡ªåŠ¨ç”Ÿæˆçš„ä¾èµ–æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾é¡¹ç›®ç”¨åˆ°çš„æ‰€æœ‰ npm åŒ…ã€‚
* **ä¸éœ€è¦æ‰‹åŠ¨æ›´æ”¹å†…å®¹ï¼Œé€šå¸¸ä¸æäº¤åˆ° Git ä»“åº“ã€‚**

2. **`public/`**

* å­˜æ”¾é™æ€èµ„æºï¼Œæ‰“åŒ…æ—¶å†…å®¹**åŸæ ·æ‹·è´**åˆ°æœ€ç»ˆçš„æ„å»ºç›®å½• (`dist`)ã€‚

| æ–‡ä»¶/ç›®å½•     | è¯´æ˜                                                                                     |
| ------------- | ---------------------------------------------------------------------------------------- |
| `index.html`  | å…¥å£ HTML æ¨¡æ¿ï¼ŒVue åº”ç”¨ä¼šæŒ‚è½½åœ¨è¿™é‡Œçš„ `<div id="app"></div>` ä¸­ã€‚ä½ å¯ä»¥è‡ªå®šä¹‰å¤´éƒ¨å†…å®¹ã€‚ |
| `favicon.ico` | ç½‘ç«™å›¾æ ‡ï¼Œå¯æ›¿æ¢ã€‚                                                                       |

3. **`src/`**

* é¡¹ç›®æºç ç›®å½•ï¼Œæ˜¯å¼€å‘çš„ä¸»è¦åŒºåŸŸã€‚

| æ–‡ä»¶/ç›®å½•     | è¯´æ˜                                                                       |
| ------------- | -------------------------------------------------------------------------- |
| `main.js`     | åº”ç”¨å…¥å£æ–‡ä»¶ï¼Œåˆ›å»º Vue å®ä¾‹å¹¶æŒ‚è½½åˆ° `#app`ã€‚é€šå¸¸åœ¨æ­¤æ³¨å†Œå…¨å±€ç»„ä»¶ã€æ’ä»¶ç­‰ã€‚ |
| `App.vue`     | æ ¹ç»„ä»¶ï¼Œé€šå¸¸ä½œä¸ºæ•´ä¸ªåº”ç”¨çš„æ¡†æ¶å£³ï¼Œé‡Œé¢åŒ…å« `<router-view>` æˆ–é¡µé¢ç»“æ„ã€‚    |
| `components/` | å­˜æ”¾ Vue å•æ–‡ä»¶ç»„ä»¶ï¼ˆ`.vue`ï¼‰ï¼Œå¦‚æŒ‰é’®ã€è¡¨å•ã€æ¨¡å—ç­‰ UI å•å…ƒç»„ä»¶ã€‚          |
| `assets/`     | å­˜æ”¾é™æ€èµ„æºï¼Œå¦‚å›¾ç‰‡ã€å­—ä½“ç­‰ï¼Œä¼šè¢« Webpack å¤„ç†ï¼ˆä¾‹å¦‚ hash å‘½åï¼‰ã€‚        |

* è‹¥å¯ç”¨ Vue Router / Vuexï¼ŒCLI å¯èƒ½è¿˜ä¼šæ·»åŠ è¿™äº›ç›®å½•ï¼š

| ç›®å½•      | ç”¨é€”                                                 |
| --------- | ---------------------------------------------------- |
| `views/`  | è·¯ç”±é¡µé¢ç»„ä»¶ï¼ˆæ¯ä¸ªé¡µé¢ä¸€ä¸ª `.vue` æ–‡ä»¶ï¼‰             |
| `router/` | Vue Router é…ç½®æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ `index.js`ï¼ŒåŒ…å«è·¯ç”±è¡¨ã€‚ |
| `store/`  | Vuex çŠ¶æ€ç®¡ç†ç›®å½•ã€‚                                  |

4. **é…ç½®æ–‡ä»¶**

| æ–‡ä»¶å            | ä½œç”¨                                                     |
| ----------------- | -------------------------------------------------------- |
| `.gitignore`      | é…ç½® Git å¿½ç•¥å“ªäº›æ–‡ä»¶ï¼ˆå¦‚ `node_modules/`ï¼‰              |
| `package.json`    | æè¿°é¡¹ç›®åŠä¾èµ–ã€è„šæœ¬ç­‰ä¿¡æ¯ã€‚æœ€æ ¸å¿ƒçš„é¡¹ç›®é…ç½®æ–‡ä»¶ã€‚       |
| `babel.config.js` | Babel é…ç½®ï¼Œç”¨äºè½¬è¯‘ JavaScript æ–°è¯­æ³•ã€‚                 |
| `vue.config.js`   | Vue CLI é…ç½®æ–‡ä»¶ï¼Œå¯é…ç½®æ‰“åŒ…è·¯å¾„ã€ä»£ç†ã€Webpack è®¾ç½®ç­‰ã€‚ |
| `README.md`       | é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼Œå¯å¡«å†™ä½¿ç”¨æ–¹æ³•ã€ç›®å½•è¯´æ˜ã€è¿è¡Œæ­¥éª¤ç­‰ã€‚     |

---

#### è¿è¡Œè¿‡ç¨‹

> åœ¨ Web æœåŠ¡å™¨ä¸­ï¼ˆå¦‚ Apacheã€Nginxã€Vite çš„ dev serverï¼‰ï¼Œè®¿é—®ç›®å½•æ—¶ä¼šé»˜è®¤æŸ¥æ‰¾ index.html ä½œä¸ºå…¥å£æ–‡ä»¶ã€‚

``` mermaid
graph TD
    A[è¿è¡Œ npm run dev] --> B[Vite å¯åŠ¨å¼€å‘æœåŠ¡å™¨]
    B --> C[è¯»å– index.html]
    C --> D[æŸ¥æ‰¾å¹¶æ‰§è¡Œ main.js]
    D --> E[main.js åˆ›å»º Vue å®ä¾‹]
    E --> F[åŠ è½½ App.vue]
    F --> G[App.vue æ¸²æŸ“å¹¶æŒ‚è½½åˆ° #app]
    G --> H[Vue åº”ç”¨å¼€å§‹è¿è¡Œ]

```

---

#### æ„å»ºè¿‡ç¨‹

``` mermaid
graph TD
    A[è¿è¡Œ npm run build] --> B[Vite è¯»å– vite.config.js]
    B --> C[è§£æ public/index.html]
    C --> D[æ‰¾åˆ°å…¥å£æ–‡ä»¶ main.js]
    D --> E[Rollup é€’å½’åˆ†æä¾èµ–]
    E --> F[ä»£ç åˆ†å‰² & Tree shaking]
    F --> G[åº”ç”¨æ’ä»¶ å‹ç¼©ã€è½¬æ¢ ]
    G --> H[ç”Ÿæˆæ„å»ºè¾“å‡ºæ–‡ä»¶  dist/ ]
    H --> I[æ„å»ºå®Œæˆï¼Œå¯éƒ¨ç½²]

```

## åŸºç¡€

### æ¨¡æ¿è¯­æ³•

`Vue` ä½¿ç”¨ä¸€ç§åŸºäº `HTML` çš„æ¨¡æ¿è¯­æ³•ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿ**å£°æ˜å¼**åœ°å°†å…¶ç»„ä»¶**å®ä¾‹çš„æ•°æ®** **ç»‘å®š**åˆ°å‘ˆç°çš„ `DOM` ä¸Šã€‚
> æ‰€æœ‰çš„ Vue æ¨¡æ¿éƒ½æ˜¯è¯­æ³•å±‚é¢åˆæ³•çš„ HTMLï¼Œå¯ä»¥è¢«ç¬¦åˆè§„èŒƒçš„æµè§ˆå™¨å’Œ HTML è§£æå™¨è§£æã€‚

åœ¨åº•å±‚æœºåˆ¶ä¸­ï¼ŒVue ä¼šå°†æ¨¡æ¿ç¼–è¯‘æˆé«˜åº¦ä¼˜åŒ–çš„ JavaScript ä»£ç ã€‚

ç»“åˆ**å“åº”å¼ç³»ç»Ÿ**ï¼Œå½“åº”ç”¨çŠ¶æ€å˜æ›´æ—¶ï¼ŒVue èƒ½å¤Ÿæ™ºèƒ½åœ°æ¨å¯¼å‡ºéœ€è¦é‡æ–°æ¸²æŸ“çš„ç»„ä»¶çš„æœ€å°‘æ•°é‡ï¼Œå¹¶åº”ç”¨æœ€å°‘çš„ DOM æ“ä½œã€‚

| åŠŸèƒ½         | è¯­æ³•                            |
| ------------ | ------------------------------- |
| æ’å€¼         | `{ { message } }`               |
| å±æ€§ç»‘å®š     | `:href="url"`                   |
| äº‹ä»¶ç»‘å®š     | `@click="handleClick"`          |
| åŒå‘æ•°æ®ç»‘å®š | `v-model="message"`             |
| åŠ¨æ€ class   | `:class="{ active: isActive }"` |
| åŠ¨æ€ style   | `:style="{ color: textColor }"` |

- **åº”ç”¨ç¤ºä¾‹ï¼š**

``` vue
<script setup>
import { ref } from 'vue'

const message = ref('Hello Vue!')
const url = ref('https://vuejs.org')
const isVisible = ref(true)
const items = ref(['è‹¹æœ', 'é¦™è•‰', 'æ©˜å­'])
const isActive = ref(true)
const textColor = ref('blue')

function handleClick() {
  alert('æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼')
}
</script>

<template>
  <!-- æ’å€¼è¯­æ³• -->
  <h1>{{ message }}</h1>

  <!-- åŒå‘ç»‘å®š -->
  <input v-model="message" placeholder="ä¿®æ”¹ message" />

  <hr/>

  <!-- å±æ€§ç»‘å®š -->
  <a :href="url" target="_blank">è®¿é—®é“¾æ¥</a>

  <hr/>
  <!-- æ¡ä»¶æ¸²æŸ“ -->
  <input v-model="isVisible" type="checkbox" />

  <p v-if="isVisible" style="display: inline-block;">è¿™ä¸ªæ®µè½æ˜¯å¯è§çš„ã€‚</p>
  <p v-else style="display: inline-block;">è¿™ä¸ªæ®µè½æ˜¯ä¸å¯è§çš„ã€‚</p>

  <hr/>

  <!-- åˆ—è¡¨æ¸²æŸ“ -->
  <ul>
    <li v-for="(item, index) in items" :key="index">
      {{ index + 1 }} - {{ item }}
    </li>
  </ul>

  <hr/>

  <!-- äº‹ä»¶å¤„ç† -->
  <button v-on:click="handleClick">ç‚¹å‡»æˆ‘</button>
  <button @click="handleClick">ç‚¹å‡»æˆ‘</button>

  <hr/>

  <!-- ç»‘å®š class å’Œ style -->
  <!-- æ’å€¼è¯­æ³•ä¸èµ·ä½œç”¨ï¼Œæ’å€¼è¯­æ³•ä¸ä¼šè¢«å½“ä½œå±æ€§è§£æ -->
  <p :class="{ active: isActive }" :style="{ color: textColor }">
    åŠ¨æ€ class å’Œ style ç¤ºä¾‹
  </p>
</template>

<style lang="sass" scoped>

</style>
```

---

- **æ¸²æŸ“æµç¨‹**

``` mermaid
graph TD
  A[æ¨¡æ¿ template] --> B[ç¼–è¯‘å™¨ compiler]
  B --> C[æ¸²æŸ“å‡½æ•° render function]
  C --> D[è™šæ‹Ÿ DOM VNode]
  D --> E[çœŸå® DOM åˆæ¬¡æ¸²æŸ“]

  subgraph å“åº”å¼æ›´æ–°æµç¨‹
    F[å“åº”å¼æ•°æ®æ”¹å˜] --> G[ä¾èµ–è¿½è¸ªè§¦å‘æ›´æ–°]
    G --> C
    C --> D2[æ–°çš„ VNode]
    D2 --> H[Diff å¯¹æ¯”æ–°æ—§ VNode]
    H --> I[Patch æ›´æ–° DOM]
  end

  E --> F

```

---

1. **æ¨¡æ¿ç¼–è¯‘**

åœ¨å¼€å‘æ—¶ï¼Œä½ å†™çš„ï¼š

```html
<h1>{{ message }}</h1>
```

Vue ç¼–è¯‘å™¨ä¼šå°†å…¶è½¬æ¢ä¸ºç±»ä¼¼è¿™æ ·çš„ JavaScript æ¸²æŸ“å‡½æ•°ï¼ˆä¼ªä»£ç ï¼‰ï¼š

```js
function render(ctx) {
  return h('h1', null, ctx.message)
}
```

* `h()` æ˜¯ Vue åˆ›å»ºè™šæ‹Ÿ DOM çš„å‡½æ•°ï¼ˆHyperscriptï¼‰
* `ctx` æ˜¯ç»„ä»¶å®ä¾‹çš„ä¸Šä¸‹æ–‡ï¼Œé‡Œé¢åŒ…å«äº† `message`

> âš ï¸ æ³¨æ„ï¼šVue 3 çš„æ¨¡æ¿åœ¨æ„å»ºé˜¶æ®µç”± `@vue/compiler-dom` é¢„ç¼–è¯‘æˆ `render` å‡½æ•°ï¼Œè¿™æ ·è¿è¡Œæ—¶å°±æ›´é«˜æ•ˆã€‚

---

2. **å“åº”å¼ç»‘å®šï¼ˆReactivityï¼‰**

Vue ä½¿ç”¨å“åº”å¼ç³»ç»Ÿï¼ˆåŸºäº `Proxy`ï¼‰è¿½è¸ªä¾èµ–ï¼š

```js
const message = ref('Hello')
```

å½“ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ï¼ŒVue ä¼šæŠŠ `message` è¯»å–è¿‡ç¨‹è®°å½•ä¸ºä¾èµ–ã€‚

å½“ä½ ä¿®æ”¹å®ƒï¼š

```js
message.value = 'Hi'
```

Vue ä¼šè§¦å‘å¯¹åº”çš„æ¸²æŸ“å‡½æ•°å†æ¬¡æ‰§è¡Œï¼Œç”Ÿæˆæ–°çš„ **VNode æ ‘ï¼ˆè™šæ‹Ÿ DOMï¼‰**ã€‚

---

3. **è™šæ‹Ÿ DOM æ¯”è¾ƒï¼ˆDiffï¼‰å’Œ Patch**

æ¯æ¬¡å“åº”å¼æ•°æ®å˜åŠ¨æ—¶ï¼ŒVue ä¼šï¼š

1. ä½¿ç”¨æ–°çš„æ•°æ®ç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOMï¼ˆVNodeï¼‰
2. ä¸æ—§çš„è™šæ‹Ÿ DOM è¿›è¡Œ diff æ¯”è¾ƒ
3. é€šè¿‡æœ€å°åŒ–æ›´æ–°æ“ä½œï¼Œ**æ‰“è¡¥ä¸**åˆ°çœŸå® DOM ä¸Šï¼ˆpatchï¼‰

> ä¼˜ç‚¹ï¼šæ€§èƒ½é«˜ï¼Œä¸éœ€è¦å®Œå…¨é‡æ–°æ¸²æŸ“ DOMï¼Œåªæ›´æ–°å˜åŠ¨çš„éƒ¨åˆ†ã€‚

---

- **æ³¨æ„äº‹é¡¹**

1. **æ’å€¼è¯­æ³•ä¸èƒ½ç”¨äº HTML å±æ€§**

```html
<!-- é”™è¯¯ -->
<a href="{{ url }}">ç‚¹å‡»</a> <!-- ä¸ä¼šè§£æ -->

<!-- æ­£ç¡® -->
<a :href="url">ç‚¹å‡»</a>
```

æ’å€¼ `{{ }}` åªèƒ½ç”¨äºå…ƒç´ å†…å®¹ï¼Œä¸èƒ½ç”¨äºå±æ€§ã€‚

---

2.  **`v-bind` ç®€å†™ä¸º `:`ï¼Œ`v-on` ç®€å†™ä¸º `@`**

```html
<!-- å®Œæ•´å†™æ³• -->
<img v-bind:src="imageUrl">
<button v-on:click="submit">æäº¤</button>

<!-- æ¨èå†™æ³• -->
<img :src="imageUrl">
<button @click="submit">æäº¤</button>
```

---

3.  **æ¨¡æ¿ä¸­ä¸èƒ½ä½¿ç”¨ JavaScript è¯­å¥**

```html
<!-- é”™è¯¯ -->
<p>{{ if (ok) { return 'yes' } }}</p>

<!-- æ­£ç¡®ï¼ˆè¡¨è¾¾å¼å¯ä»¥ï¼‰ -->
<p>{{ ok ? 'yes' : 'no' }}</p>
```

> åªèƒ½å†™**è¡¨è¾¾å¼**ï¼Œä¸èƒ½å†™å®Œæ•´è¯­å¥ï¼ˆå¦‚ ifã€forã€whileã€return ç­‰ï¼‰ã€‚

---

4. **åŒå‘ç»‘å®š (`v-model`) åªèƒ½ç”¨äºè¡¨å•å…ƒç´ **

```html
<!-- æ­£ç¡® -->
<input v-model="username" />

<!-- é”™è¯¯ -->
<!-- v-model ä¸èƒ½ç”¨åœ¨ <div>ã€<p> ç­‰éè¡¨å•å…ƒç´ ä¸Š -->
<div v-model="username"></div>
```

---

5. **ç»‘å®š class/style æ¨èä½¿ç”¨å¯¹è±¡æˆ–æ•°ç»„è¯­æ³•**

```html
<!-- æ¨è -->
<p :class="{ active: isActive }"></p>
<p :style="{ color: textColor }"></p>

<!-- ä¸æ¨è -->
<p class="{{ isActive ? 'active' : '' }}"></p> <!-- æ— æ•ˆ -->
```

---

6. **æ ¹èŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªï¼ˆåœ¨ Vue 2ï¼‰**

* Vue 2ï¼šæ¨¡æ¿åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ï¼ˆå¦‚ `<div>`ï¼‰
* Vue 3ï¼šå…è®¸å¤šä¸ªæ ¹èŠ‚ç‚¹

---

7. **HTML ä¼šè¢«è‡ªåŠ¨è½¬ä¹‰ï¼Œé™¤éä½¿ç”¨ `v-html`**

```html
<!-- æ¸²æŸ“ä¸ºå­—ç¬¦ä¸² -->
<p>{{ '<strong>hello</strong>' }}</p>

<!-- æ¸²æŸ“ä¸º HTML -->
<p v-html="htmlContent"></p>
```

> ä½¿ç”¨ `v-html` æ—¶æ³¨æ„é˜²æ­¢ XSS æ”»å‡»ã€‚

---

### å“åº”å¼åŸºç¡€

Vue çš„ **å“åº”å¼ç³»ç»Ÿ** æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œèƒ½å¤Ÿè®© **æ•°æ®** å’Œ **è§†å›¾** ä¿æŒåŒæ­¥ã€‚å½“æ•°æ®å˜åŒ–æ—¶ï¼Œè§†å›¾ä¼šè‡ªåŠ¨æ›´æ–°ã€‚

- **åº”ç”¨ç¤ºä¾‹(Vu3)ï¼š**


``` vue
<script setup>
import { ref, onMounted } from 'vue'

onMounted(() => {
})

const count = ref(0);

function increment() {
  //jsä¸­ç”¨.value
  count.value++
}

const person = ref({
  name: 'Seven Chen',
  age: 28,
  child:{
    name: 'Little Seven Chen',
    age: 9,
  }
});

function incrementAge() {
  //jsä¸­ç”¨.value
  //åŒ…è£…åœ¨ç¬¬ä¸€å±‚
  person.value.age++
}

function incrementChildAge() {
  //jsä¸­ç”¨.value
  //åŒ…è£…åœ¨ç¬¬ä¸€å±‚
  person.value.child.age++
}

const personList = ref([
{
  name: 'SC',
  age: 30,
  child:[
  {
    name: 'LSC',
    age: 10,
  }]
},
{
  name: 'SCA',
  age: 31,
  child:[
  {
    name: 'LSCA1',
    age: 11,
  }]
}
])

function decreaseListAge(){
  personList.value.forEach(person => {
    person.age --
    if(person.child){
      person.child.forEach(child => {
        child.age--
      })
    }
  })
}

function incremenListtAge(){
  personList.value.forEach(person => {
    person.age ++
    if(person.child){
      person.child.forEach(child => {
        child.age++
      })
    }
  })
}

function removePerson(){
  personList.value.forEach(person => {
    if(person.child){
      person.child.pop()
    }
  })
}

function addPerson(){
  personList.value.forEach(person => {
    if(person.child){
      person.child.push({
        name: 'ADD',
        age: 11,
      })
    }
  })
}
</script>

<template>
  <el-card >
    <template #header>ref åˆ›å»ºå“åº”å¼å˜é‡</template>
    
    <!-- templateä¸­ç”¨å˜é‡æœ¬èº« -->
    <button @click="count--">-</button>
    <span style="margin: 0 10px;">{{count}}</span>
    <button @click="increment">+</button>
  </el-card>
  <br/>
  <el-card >
    <template #header>ref åˆ›å»ºå“åº”å¼å¯¹è±¡</template>
    
    <!-- templateä¸­ç”¨å˜é‡æœ¬èº« -->

    <p>{{ person.name }}</p>
    <button @click="person.age--">-</button>
    <span style="margin: 0 10px;">{{ person.age }}</span>
    <button @click="incrementAge">+</button>

    <p>{{ person.child.name }}</p>
    <button @click="person.child.age--">-</button>
    <span style="margin: 0 10px;">{{ person.child.age }}</span>
    <button @click="incrementChildAge">+</button>
    <p>{{ person }}</p>
  </el-card>
  <br/>
  <el-card >
    <template #header>ref åˆ›å»ºå“åº”å¼å¯¹è±¡æ•°ç»„</template>
    
    <!-- templateä¸­ç”¨å˜é‡æœ¬èº« -->
    <p>æ“ä½œå±æ€§</p>
    <button @click="decreaseListAge">-</button>
    <button @click="incremenListtAge">+</button>
    <p>æ“ä½œå¯¹è±¡</p>
    <button @click="removePerson">-</button>
    <button @click="addPerson">+</button>
    <p>{{ personList }}</p>
  </el-card>
</template>


<style scoped>

</style>

```

::: warning æ³¨æ„ 
1. **vue 2æˆ–é€‰é¡¹å¼é£æ ¼åªéœ€è¦å°†æ•°æ®æ”¾è¿›dataé‡Œå³å¯ï¼š**
æ¯”å¦‚
   
``` vue
export default {
  data() {
    return {
      count: 1
    }
  },

  // `mounted` æ˜¯ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä¹‹åæˆ‘ä»¬ä¼šè®²åˆ°
  mounted() {
    // `this` æŒ‡å‘å½“å‰ç»„ä»¶å®ä¾‹
    console.log(this.count) // => 1

    // æ•°æ®å±æ€§ä¹Ÿå¯ä»¥è¢«æ›´æ”¹
    this.count = 2
  }
}
```

2. **æ–°é¡¹ç›®(Vue 3.2+)æ¨èä½¿ç”¨ `<script setup>`æ›¿æ¢`setup()`ï¼Œæ—§é¡¹ç›®åªèƒ½ä½¿ç”¨ `setup()`**
``` vue
import { ref } from 'vue'

export default {
  // `setup` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é’©å­ï¼Œä¸“é—¨ç”¨äºç»„åˆå¼ APIã€‚
  setup() {
    const count = ref(0)

    // å°† ref æš´éœ²ç»™æ¨¡æ¿
    return {
      count
    }
  }
}
```

| `<script setup>`åŠŸèƒ½       | ç¼–è¯‘é˜¶æ®µåšäº†ä»€ä¹ˆ                                                   |
| -------------------------- | ------------------------------------------------------------------ |
| è‡ªåŠ¨è°ƒç”¨ `setup()`         | Vue è‡ªåŠ¨æŠŠä½ å†™çš„é¡¶å±‚å˜é‡ã€å‡½æ•°ç­‰å°è£…è¿› `setup()` ä¸­                |
| è‡ªåŠ¨ `return` æ‰€æœ‰é¡¶å±‚ç»‘å®š | æ‰€æœ‰å˜é‡/å‡½æ•°éƒ½è‡ªåŠ¨æš´éœ²ç»™æ¨¡æ¿ï¼Œæ— éœ€æ‰‹åŠ¨ `return`                   |
| æ”¯æŒå®å‡½æ•°                 | ç¼–è¯‘æ—¶è¯†åˆ« `defineProps`ã€`defineEmits`ã€`defineExpose` ç­‰ç‰¹æ®Šè¯­æ³• |
| æ›´å¥½æ”¯æŒç±»å‹æ¨å¯¼           | å°¤å…¶åœ¨ TypeScript ä¸­ï¼Œå˜é‡ä½œç”¨åŸŸæ˜ç¡®ï¼Œæ— éœ€è§£æ„é‡èµ‹å€¼               |
| æ¨¡å—æå‡                   | é¡¶å±‚å¯¼å…¥/å®šä¹‰æå‡å‡º `setup()`ï¼Œé¿å…é‡å¤åˆ›å»ºå¯¹è±¡                    |

3. **å¯ä»¥é€šè¿‡ shallow ref æ¥æ”¾å¼ƒæ·±å±‚å“åº”æ€§ã€‚å¯¹äºæµ…å±‚ refï¼Œåªæœ‰ .value çš„è®¿é—®ä¼šè¢«è¿½è¸ªã€‚ç”¨äºé¿å…å¯¹å¤§å‹æ•°æ®çš„å“åº”æ€§å¼€é”€æ¥ä¼˜åŒ–æ€§èƒ½ã€æˆ–è€…æœ‰å¤–éƒ¨åº“ç®¡ç†å…¶å†…éƒ¨çŠ¶æ€çš„æƒ…å†µã€‚**
4. **åªæœ‰ä»£ç†å¯¹è±¡æ˜¯å“åº”å¼çš„ï¼Œæ›´æ”¹åŸå§‹å¯¹è±¡ä¸ä¼šè§¦å‘æ›´æ–°ã€‚å› æ­¤ï¼Œä½¿ç”¨ Vue çš„å“åº”å¼ç³»ç»Ÿçš„æœ€ä½³å®è·µæ˜¯ä»…ä½¿ç”¨ä½ å£°æ˜å¯¹è±¡çš„ä»£ç†ç‰ˆæœ¬ã€‚**
``` js
  const raw = {}
  const proxy = reactive(raw)

  // ä»£ç†å¯¹è±¡å’ŒåŸå§‹å¯¹è±¡ä¸æ˜¯å…¨ç­‰çš„
  console.log(proxy === raw) // false

  const raw1 = {}
  const proxy1 = ref(raw1)

  // ä»£ç†å¯¹è±¡å’ŒåŸå§‹å¯¹è±¡ä¸æ˜¯å…¨ç­‰çš„
  console.log(proxy1 === raw1) // false 
  console.log(proxy1.value === raw1) // false 
```
5. **reactive() çš„å±€é™æ€§**
   1. **åªèƒ½ç”¨äºå¯¹è±¡ç±»å‹ (å¯¹è±¡ã€æ•°ç»„å’Œå¦‚ Mapã€Set è¿™æ ·çš„é›†åˆç±»å‹)ã€‚å®ƒä¸èƒ½æŒæœ‰å¦‚ stringã€number æˆ– boolean è¿™æ ·çš„åŸå§‹ç±»å‹ã€‚**
   2. **ä¸èƒ½è½»æ˜“åœ°â€œæ›¿æ¢â€å“åº”å¼å¯¹è±¡ï¼Œå› ä¸ºè¿™æ ·çš„è¯ä¸ç¬¬ä¸€ä¸ªå¼•ç”¨çš„å“åº”æ€§è¿æ¥å°†ä¸¢å¤±**
   > **ref æ›¿æ¢ .value: æœ¬ä½“ä¸å˜ï¼ˆå“åº”ç³»ç»Ÿä¾ç„¶è¿½è¸ªï¼‰.value è¢« Vue å“åº”å¼ä»£ç†ï¼Œæ›¿æ¢åè§†å›¾è‡ªåŠ¨æ›´æ–°**

   > **reactive æ›¿æ¢æ•´ä¸ªå˜é‡ï¼šuser = {...} å…¶å®æ˜¯ç»™ user å˜é‡èµ‹äº†æ–°å€¼, åŸæœ‰çš„å“åº”å¼è¿½è¸ªå¯¹è±¡å·²ç»æ–­å¼€ï¼Œæ–°å€¼ä¸æ˜¯å“åº”å¼çš„**

   > **å¦‚æœå¿…é¡»ä½¿ç”¨ reactiveï¼Œåº”ä¿®æ”¹å±æ€§è€Œéæ›¿æ¢å¯¹è±¡**
    ``` js
    let replace1 = reactive({ count1: 0 })

    function replaceReactive() {
      replace1 = { summer: replaceCounter++ } // æ—§å¼•ç”¨å¤±æ•ˆï¼ŒåŸæœ‰å“åº”æ–­è£‚
    }

    let replace2 =  ref({ count2: 0 })

    function replaceRef() {
      replace2.value =  { summer: replaceCounter++ }  // æ²¡æœ‰é—®é¢˜ï¼Œè§†å›¾æ­£å¸¸æ›´æ–°
    }
    ```
   3. **å°†å“åº”å¼å¯¹è±¡çš„åŸå§‹ç±»å‹å±æ€§è§£æ„ä¸ºæœ¬åœ°å˜é‡æ—¶ï¼Œæˆ–è€…å°†è¯¥å±æ€§ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œå°†ä¸¢å¤±å“åº”æ€§è¿æ¥**
    > **æ— è®ºæ˜¯reactiveè¿˜æ˜¯refï¼Œåªè¦è§£æ„å¯¹è±¡å†…éƒ¨å±æ€§ï¼Œæ‹¿åˆ°çš„éƒ½æ˜¯å€¼ç±»å‹ï¼Œå› æ­¤æ‰€æ‹¿åˆ°çš„å˜é‡ä¸åŸå¯¹è±¡ä¸å†æœ‰å…³è”ã€‚**

    > **å¦‚æœéœ€è¦ç»“æ„åçš„å˜é‡å…·æœ‰å“åº”å¼ï¼Œä½¿ç”¨"toRefs()"**

    > **refè§£å†³ ç»“æ„/è§£æ„å“åº”æ€§ä¸¢å¤± çš„é—®é¢˜æ˜¯æŒ‡ä»¥ refä¸ºæ•´ä½“æ—¶ä¿æŒå“åº”å¼**

    ``` js
      const state = reactive({ count: 0 })
      // å½“è§£æ„æ—¶ï¼Œcount å·²ç»ä¸ state.count æ–­å¼€è¿æ¥
      let { count } = state
      // ä¸ä¼šå½±å“åŸå§‹çš„ state
      count++
      // è¯¥å‡½æ•°æ¥æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªæ™®é€šçš„æ•°å­—
      // å¹¶ä¸”æ— æ³•è¿½è¸ª state.count çš„å˜åŒ–
      // æˆ‘ä»¬å¿…é¡»ä¼ å…¥æ•´ä¸ªå¯¹è±¡ä»¥ä¿æŒå“åº”æ€§
      callSomeFunction(state.count)
    ```

::: danger reactive ä¸ ref å¦‚ä½•é€‰æ‹©
> **reactive æ›¿æ¢å¯¹è±¡ä¼šä¸§å¤±å“åº”å¼ï¼ˆæ–°å¯¹è±¡å¦‚æœä¸æ˜¯å“åº”å¼å¯èƒ½ä¼šå­˜åœ¨é—®é¢˜ï¼‰ï¼Œref ç›‘å¬æ—¶é»˜è®¤ä¸å¼€å¯æ·±åº¦ç›‘å¬**
> 
> **ä¸¤ä¸ªéƒ½ä¸æ˜¯ä¸¥é‡çš„ç¼ºé™·ï¼Œå»ºè®®ç»Ÿä¸€ä½¿ç”¨è§„èŒƒã€‚è¦ä¹ˆå¯¹è±¡éƒ½ç”¨reactiveï¼ˆå¯¹ å¯¹è±¡å±æ€§é‡æ–°èµ‹å€¼ï¼‰ï¼Œå€¼éƒ½ç”¨refï¼›è¦ä¹ˆéƒ½ç”¨refï¼ˆwatchæ—¶å¼€å¯æ·±åº¦ç›‘å¬ï¼‰ã€‚**
:::

- **å®ç°åŸç†ï¼š**

Vue 2 å’Œ Vue 3 çš„å“åº”å¼ç³»ç»Ÿå®ç°åŸç†æœ‰æ ¹æœ¬æ€§åŒºåˆ«ï¼Œä¸»è¦ä½“ç°åœ¨ï¼š

* **Vue 2ï¼šåŸºäº Object.definePropertyï¼ˆè¿è¡Œæ—¶åŠ«æŒï¼‰**
* **Vue 3ï¼šåŸºäº Proxyï¼ˆç¼–è¯‘æ—¶å¯æ‹“å±•çš„ä»£ç†ï¼‰**

---

- **Vue 2 å“åº”å¼åŸç†ï¼ˆåŸºäº `Object.defineProperty`ï¼‰**

  1. Vue ä¼šé€’å½’éå†å¯¹è±¡çš„æ¯ä¸ªå±æ€§
  2. ä½¿ç”¨ `Object.defineProperty` åŠ«æŒæ¯ä¸ªå±æ€§çš„ getter å’Œ setter
  3. åœ¨ getter ä¸­æ”¶é›†ä¾èµ–ï¼ˆDepï¼‰
  4. åœ¨ setter ä¸­è§¦å‘æ›´æ–°ï¼ˆé€šçŸ¥ Watcherï¼‰

```mermaid
graph TD
  A[åˆå§‹åŒ– data] --> B[é€’å½’éå†å¯¹è±¡å±æ€§]
  B --> C[ä½¿ç”¨ Object.defineProperty è®¾ç½® getter/setter]
  C --> D[ç”¨æˆ·è®¿é—®å±æ€§ -> è°ƒç”¨ getter]
  D --> E[Dep æ”¶é›† Watcher]
  C --> F[ç”¨æˆ·è®¾ç½®å±æ€§ -> è°ƒç”¨ setter]
  F --> G[é€šçŸ¥ Watcher æ›´æ–°è§†å›¾]
```

- **å­˜åœ¨çš„é—®é¢˜ï¼š**

   * **åªèƒ½ç›‘å¬å±æ€§ï¼Œä¸æ”¯æŒæ•°ç»„ç´¢å¼•æˆ–æ–°å¢å±æ€§**
   * **æ·±å±‚å¯¹è±¡è¦é€’å½’éå†æ‰€æœ‰å­—æ®µï¼Œæ€§èƒ½å·®**
   * **æ— æ³•æ£€æµ‹ `arr[0] = xxx` æˆ– `obj.newProp = 123`**

---

- **Vue 3 å“åº”å¼åŸç†ï¼ˆåŸºäº `Proxy`ï¼‰**
> å½“ ref çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œref() ä¼šåœ¨å†…éƒ¨è°ƒç”¨ reactiveã€‚
  1. ä½¿ç”¨ `Proxy` ä»£ç†æ•´ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯å•ä¸ªå±æ€§
  2. åœ¨ `get` æ‹¦æˆªå™¨ä¸­è‡ªåŠ¨æ”¶é›†ä¾èµ–
  3. åœ¨ `set` æ‹¦æˆªå™¨ä¸­è‡ªåŠ¨è§¦å‘æ›´æ–°
  4. å“åº”å¼è¿½è¸ªé€šè¿‡å…¨å±€çš„ `effect()` æœºåˆ¶å®ç°

```mermaid
graph TD
  A[reactive ] --> B[è¿”å› Proxy å¯¹è±¡]
  B --> C[ç”¨æˆ·è®¿é—®å±æ€§ -> è§¦å‘ get]
  C --> D[è°ƒç”¨ track  æ”¶é›†ä¾èµ–]
  B --> E[ç”¨æˆ·ä¿®æ”¹å±æ€§ -> è§¦å‘ set]
  E --> F[è°ƒç”¨ trigger  é€šçŸ¥æ›´æ–°]
```

- **ä¼˜ç‚¹ï¼š**

  * æ”¯æŒ **æ•°ç»„ç´¢å¼•ã€æ–°å¢å±æ€§ã€åˆ é™¤å±æ€§ç­‰å…¨éƒ¨æ“ä½œ**
  * **æƒ°æ€§ä»£ç†**ï¼ˆä¸é€’å½’ï¼‰æ€§èƒ½æ›´å¥½
  * æ›´å¥½æ”¯æŒ Mapã€Setã€WeakMap ç­‰å¤æ‚æ•°æ®ç»“æ„

---

| ç‰¹æ€§              | Vue 2 (`defineProperty`) | Vue 3 (`Proxy`)      |
| ----------------- | ------------------------ | -------------------- |
| æ”¯æŒæ–°å¢/åˆ é™¤å±æ€§ | âŒ éœ€è¦ Vue.set           | âœ… åŸç”Ÿæ”¯æŒ           |
| æ·±åº¦åµŒå¥—æ€§èƒ½      | âŒ åˆå§‹åŒ–æ—¶å…¨é€’å½’         | âœ… æƒ°æ€§é€’å½’ï¼ŒæŒ‰éœ€åŠ«æŒ |
| æ”¯æŒæ•°ç»„ç´¢å¼•å“åº”  | âŒ ä¸å®Œå…¨                 | âœ… å®Œå…¨æ”¯æŒ           |
| æ”¯æŒ Map/Set      | âŒ ä¸æ”¯æŒ                 | âœ… æ”¯æŒ               |
| æ•°æ®è¿½è¸ªèƒ½åŠ›      | ä¸€å¯¹å¤šï¼ˆDep -> Watcherï¼‰ | å¤šå¯¹å¤šï¼ˆtargetMapï¼‰  |
| å®ç°æ–¹å¼          | è¿è¡Œæ—¶éå†å±æ€§           | ç¼–è¯‘æœŸç”Ÿæˆ Proxy     |

> Vue 3 åœ¨è®¿é—®å¯¹è±¡å†…éƒ¨å±æ€§ä¹‹å‰ï¼Œä¸ä¼šé€’å½’åŠ«æŒå®ƒçš„å­å¯¹è±¡ã€‚åªæœ‰åœ¨ä½ è®¿é—®çš„æ—¶å€™æ‰ä¼šä»£ç†å®ƒã€‚

---

### è®¡ç®—å±æ€§
è®¡ç®—å±æ€§æ˜¯ Vue æä¾›çš„ä¸€ç§åŸºäºå…¶å“åº”å¼ç³»ç»Ÿçš„ç‰¹æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬æ ¹æ®å·²æœ‰çš„å“åº”å¼æ•°æ®å£°æ˜å¼åœ°è®¡ç®—å‡ºæ–°çš„å€¼ï¼Œå¹¶åœ¨ä¾èµ–é¡¹å˜æ›´æ—¶è‡ªåŠ¨æ›´æ–°ç»“æœã€‚

> **åªæœ‰ä¾èµ–çš„æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ã€‚**

- **åº”ç”¨ç¤ºä¾‹(Vu3)**

``` vue
<template>
  <el-card >
    <template #header>åŸºæœ¬ç”¨æ³•</template>
    
    <!-- templateä¸­ç”¨å˜é‡æœ¬èº« -->
    <p>å§“ï¼š{{ lastName }}</p>
    <p>åï¼š{{ firstName }}</p>
    <p>å§“å(è®¡ç®—å±æ€§)ï¼š{{ fullName }}</p>
    <p>å§“å(æ–¹æ³•)ï¼š{{ (() => { return `${lastName} ${firstName} `})() }}</p>
    <el-button @click="generateName">éšæœºç”Ÿæˆå§“å</el-button>
    
    <p>å§“å(å¯å†™è®¡ç®—å±æ€§)ï¼š{{ fullNameWriteable }}</p>
    <el-button @click="generateFullName">éšæœºç”Ÿæˆå§“å-å†™å…¥è®¡ç®—å±æ€§</el-button>

    <p>å§“å(ç”Ÿæˆè®°å½•)ï¼š{{ previousName }}</p>
  </el-card>
  <br/>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue';
import { fakerZH_CN as faker } from '@faker-js/faker'

const firstName = ref('')
const lastName = ref('')

const previousName = ref('')

onMounted(() => {
  firstName.value = faker.person.firstName() // å
  lastName.value = faker.person.lastName()  // å§“
})

// è®¡ç®—å±æ€§
const fullName = computed((previous) => {
  previousName.value = String(previous)
  return `${lastName.value} ${firstName.value} `
})

function generateName(){
  firstName.value = faker.person.firstName() // å
  lastName.value = faker.person.lastName()  // å§“
}

const fullNameWriteable = computed({
  get(previous) {
    previousName.value = String(previous)
    return `${lastName.value} ${firstName.value}`
  },

  set(newValue) {
    // æ³¨æ„ï¼šæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯è§£æ„èµ‹å€¼è¯­æ³•
    [firstName.value, lastName.value] = String(newValue).split(' ')
  }
})

function generateFullName(){
  fullNameWriteable.value = `${faker.person.firstName()} ${faker.person.lastName()}`
}

</script>

<style scoped>

</style>
```

::: warning æ³¨æ„
1. vue2 å†™æ³•
``` vue
export default {
  data() {
    return {
      author: {
        name: 'John Doe',
        books: [
          'Vue 2 - Advanced Guide',
          'Vue 3 - Basic Guide',
          'Vue 4 - The Mystery'
        ]
      }
    }
  },
  computed: {
    // ä¸€ä¸ªè®¡ç®—å±æ€§çš„ getter
    publishedBooksMessage() {
      // `this` æŒ‡å‘å½“å‰ç»„ä»¶å®ä¾‹
      return this.author.books.length > 0 ? 'Yes' : 'No'
    }
  }
}
```

2. å°†åŒæ ·çš„å‡½æ•°å®šä¹‰ä¸ºä¸€ä¸ªæ–¹æ³•è€Œä¸æ˜¯è®¡ç®—å±æ€§ï¼Œä¸¤ç§æ–¹å¼åœ¨ç»“æœä¸Šç¡®å®æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œä¸åŒä¹‹å¤„åœ¨äºè®¡ç®—å±æ€§å€¼ä¼šåŸºäºå…¶å“åº”å¼ä¾èµ–è¢«ç¼“å­˜ã€‚
è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆä¸‹é¢çš„è®¡ç®—å±æ€§æ°¸è¿œä¸ä¼šæ›´æ–°ï¼Œå› ä¸º Date.now() å¹¶ä¸æ˜¯ä¸€ä¸ªå“åº”å¼ä¾èµ–ï¼š
``` js
const now = computed(() => Date.now())
```
:::

---

### æ¡ä»¶æ¸²æŸ“

æ¡ä»¶æ¸²æŸ“ï¼ˆConditional Renderingï¼‰ æ˜¯æ§åˆ¶æ¨¡æ¿ä¸­å…ƒç´ æ˜¯å¦æ˜¾ç¤ºçš„å…³é”®æŠ€æœ¯ã€‚å®ƒåŸºäº JavaScript è¡¨è¾¾å¼çš„çœŸå‡å€¼ï¼ŒåŠ¨æ€åœ°æ’å…¥æˆ–ç§»é™¤ DOM å…ƒç´ ï¼Œä»è€Œå®ç°çµæ´»çš„ç•Œé¢äº¤äº’ã€‚

- **åº”ç”¨ç¤ºä¾‹(Vu3)**

``` vue
<template>
  <el-card >
    <template #header>v-if</template>
    
    <p v-if="loggedIn">æ¬¢è¿å›æ¥ï¼</p>
    <p v-else>è¯·å…ˆç™»å½•ã€‚</p>
    <el-button @click="loggedIn = !loggedIn">åˆ‡æ¢ç™»å½•çŠ¶æ€</el-button>
  </el-card>
  <br/>
  <el-card >
    <template #header>v-show</template>
    
    <p v-show="toggle">è¿™æ®µè¯åªæ˜¯è¢« display:none äº†</p>
    <el-button @click="toggle = !toggle">æ˜¾ç¤º / éšè—</el-button>
  </el-card>
</template>

<script setup>
import { ref} from 'vue';

const loggedIn = ref(false)

const toggle = ref(true)

</script>

<style scoped>

</style>
```

::: warning v-if ä¸ v-show çš„é€‰æ‹©æ¯”è¾ƒ

| å¯¹æ¯”ç‚¹       | `v-if`                                 | `v-show`                                |
| ------------ | -------------------------------------- | --------------------------------------- |
| æ¸²æŸ“ç­–ç•¥     | **æŒ‰éœ€åˆ›å»º/é”€æ¯** DOM å…ƒç´              | åˆ›å»ºä¸€æ¬¡ï¼Œä¹‹åä»…åˆ‡æ¢ `display`          |
| åˆå§‹æ¸²æŸ“å¼€é”€ | è¾ƒå¤§ï¼ˆæ¯æ¬¡æ¡ä»¶å˜æ›´éƒ½é‡æ–°æ¸²æŸ“ï¼‰         | è¾ƒå°ï¼ˆå§‹ç»ˆå­˜åœ¨ï¼‰                        |
| é€‚åˆåœºæ™¯     | é¢‘ç¹åˆ‡æ¢ä¸å»ºè®®ï¼Œé€‚åˆæ¡ä»¶å˜åŒ–è¾ƒå°‘çš„å†…å®¹ | é€‚åˆé¢‘ç¹åˆ‡æ¢å¯è§æ€§çš„å†…å®¹ï¼ˆå¦‚ Tab åˆ‡æ¢ï¼‰ |
| DOM ä¿ç•™çŠ¶æ€ | è¢«é”€æ¯ï¼ŒçŠ¶æ€ä¸¢å¤±                       | çŠ¶æ€ä¿ç•™                                |

:::

::: danger æ³¨æ„
1. ä¸èƒ½åŒæ—¶ä½¿ç”¨ v-if å’Œ v-for åœ¨åŒä¸€å…ƒç´ ä¸Š
> å¯è¯»æ€§å·®ï¼Œå®¹æ˜“è¯¯è§£ä¼˜å…ˆçº§ã€‚ä¼šè¯¯è®¤ä¸ºå…ˆåˆ¤æ–­ v-if å†éå†ã€‚å®é™…æ˜¯å…ˆéå†ï¼Œå†åˆ¤æ–­æ˜¯å¦æ¸²æŸ“ã€‚
``` html
<!-- ä¸æ¨è -->
<li v-for="item in list" v-if="item.visible">{{ item.name }}</li>

<!-- æ¨èæ–¹å¼ -->
<li v-for="item in list" v-show="item.visible">{{ item.name }}</li>

<!-- æˆ–è€… -->

const visibleItems = computed(() => list.value.filter(item => item.visible))

```

2. v-else å’Œ v-else-if å¿…é¡»ç´§è·Ÿ v-if å…ƒç´ 
3. v-show ä¸å½±å“ v-if çš„æ¸²æŸ“é€»è¾‘
:::

### åˆ—è¡¨æ¸²æŸ“

- **åº”ç”¨ç¤ºä¾‹(Vu3)**

``` vue
<template>
  <el-card >
    <template #header>v-for éå†æ•°ç»„</template>
    
    <ul>
      <li v-for="(airline, i) in airlines" :key="i">{{ i }} - {{ airline }}</li>
    </ul>
    <el-button @click="generateAirlines">éšæœºç”Ÿæˆé£æœº</el-button>
  </el-card>
  <br/>
  <el-card >
    <template #header>v-for éå†å¯¹è±¡</template>
    
    <ul>
      <li v-for="(value, key) in person" :key="key">
        <template v-if="getType(value) === 'Object'">
          {{ key }}:
          <ul>
            <li v-for="(value, key) in value" :key="key">{{ key }}: {{ value }}</li>
          </ul>
        </template>
        <template v-else>
          {{ key }}: {{ value }}
        </template>
      </li>
    </ul>
    <el-button @click="generatePerson">éšæœºç”Ÿæˆäººå‘˜ä¿¡æ¯</el-button>
  </el-card>
  <br/>
  <el-card >
    <template #header>v-for éå†æŒ‡å®šæ¬¡æ•° <el-tag>win + ã€‚å¯ä»¥è¾“å…¥è¡¨æƒ…</el-tag></template>
    
    <el-button @click="generateNumber">éšæœºnä¸ªğŸ˜¶â€ğŸŒ«ï¸</el-button>
    <div>
      <span v-for="n in number" :key="n">ğŸ˜¶â€ğŸŒ«ï¸</span>
    </div>

  </el-card>
  <br/>
</template>

<script setup>
import { ref, onMounted } from 'vue';
import { fakerZH_CN as faker } from '@faker-js/faker' 
import { getType } from '@/common'

const airlines = ref([])
const person = ref({})
const number = ref(0)

onMounted(() => {
  generateAirlines()
  generatePerson()
  generateNumber()
});

function generateAirlines(){
  airlines.value.length = 0;
  for (let index = 0; index < 10; index++) {
    airlines.value.push(faker.airline.airline())
  }
}

function generatePerson(){
  person.value = {
    id: faker.string.uuid(),
    fullName: faker.person.fullName(),
    gender: faker.person.sexType(),
    birthday: faker.date.birthdate({ min: 18, max: 65, mode: 'age' }),
    email: faker.internet.email(),
    phone: faker.phone.number(),
    address: {
      country: faker.location.country(),
      city: faker.location.city(),
      street: faker.location.streetAddress(),
      zipCode: faker.location.zipCode(),
    },
    avatar: faker.image.avatar(),
    job: {
      title: faker.person.jobTitle(),
      type: faker.person.jobType(),
      area: faker.person.jobArea(),
    },
  }
}

function generateNumber(){
  number.value = Math.floor(Math.random() * 100) + 1
}

</script>

<style scoped>

</style>
```

::: danger æ³¨æ„
1. ä½¿ç”¨å”¯ä¸€çš„ ID ä½œä¸º keyï¼Œä¸è¦ä½¿ç”¨æ•°ç»„ç´¢å¼•ï¼Œå°¤å…¶æ˜¯åˆ—è¡¨ä¼šå¢åˆ æ’åºçš„æƒ…å†µã€‚
2. ä¸è¦åŒæ—¶ä½¿ç”¨ v-if å’Œ v-forã€‚å¿…è¦æ—¶ä½¿ç”¨templateå…ƒç´ è¿‡æ¸¡ã€‚
:::

### äº‹ä»¶å¤„ç†

äº‹ä»¶å¤„ç†æ˜¯å“åº”ç”¨æˆ·äº¤äº’ï¼ˆå¦‚ç‚¹å‡»ã€è¾“å…¥ã€æäº¤ç­‰ï¼‰æœ€å¸¸ç”¨çš„æ–¹å¼ä¹‹ä¸€ã€‚Vue æä¾›äº†ç®€å•ç›´è§‚çš„è¯­æ³•æ¥ç»‘å®š DOM äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„å¤„ç†é€»è¾‘ã€‚

- **äº‹ä»¶ä¿®é¥°ç¬¦åˆ—è¡¨**
  - `.stop`ï¼šå•å‡»äº‹ä»¶å°†åœæ­¢ä¼ é€’
  - `.prevent`ï¼šé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œå¦‚è¡¨å•æäº¤ï¼Œé“¾æ¥è·³è½¬ç­‰
  - `.self`ï¼šä»…å½“ event.target æ˜¯å…ƒç´ æœ¬èº«æ—¶æ‰ä¼šè§¦å‘äº‹ä»¶å¤„ç†å™¨
  - `.capture`ï¼šåœ¨è¢«å†…éƒ¨å…ƒç´ å¤„ç†å‰ï¼Œå…ˆè¢«å¤–éƒ¨(parent)å¤„ç†
  - `.once`ï¼šç‚¹å‡»æŒ‰é’®åªè§¦å‘ä¸€æ¬¡
  - `.passive`ï¼šè¢«åŠ¨ç›‘å¬ ä¾‹å¦‚è¢«åŠ¨ç›‘å¬æ»šåŠ¨ï¼ˆä¸ä¼šé˜»æ­¢é»˜è®¤æ»šåŠ¨ï¼‰ï¼Œä¸€èˆ¬ç”¨äºè§¦æ‘¸äº‹ä»¶çš„ç›‘å¬å™¨ï¼Œå¯ä»¥ç”¨æ¥æ”¹å–„ç§»åŠ¨ç«¯è®¾å¤‡çš„æ»šå±æ€§èƒ½ã€‚
  
- **é”®ç›˜äº‹ä»¶åˆ—è¡¨**
  - `.enter`
  - `.tab`
  - `.delete (æ•è·â€œDeleteâ€å’Œâ€œBackspaceâ€ä¸¤ä¸ªæŒ‰é”®)`
  - `.esc`
  - `.space`
  - `.up`
  - `.down`
  - `.left`
  - `.right`
  - `.ctrl`
  - `.alt`
  - `.shift`
  - `.meta`

- **é¼ æ ‡äº‹ä»¶åˆ—è¡¨**
  - `.left`
  - `.right`
  - `.middle`

- **è‡ªå®šä¹‰äº‹ä»¶**
  å¯ä»¥ä½¿ç”¨"emit"å®ç°è‡ªå®šä¹‰äº‹ä»¶

- **åº”ç”¨ç¤ºä¾‹(Vu3)**
  
``` vue
<template>
  <el-card >
    <template #header>åŸºæœ¬ç”¨æ³•</template>
    <!-- æ–¹æ³•å¤„ç† -->
    <p>æ–¹æ³•äº‹ä»¶å¤„ç†å™¨</p> 
    <el-button @click="sayHello">ç‚¹å‡»é—®å¥½</el-button>

    <!-- å†…è”äº‹ä»¶å¤„ç†å™¨ -->
    <p>å†…è”äº‹ä»¶å¤„ç†å™¨ å½“å‰è®¡æ•°ï¼š{{ count }}</p> 
    <el-button @click="count++">+</el-button>

    <!-- å†…è”äº‹ä»¶å¤„ç†å™¨è°ƒç”¨æ–¹æ³• -->
    <p>å†…è”äº‹ä»¶å¤„ç†å™¨è°ƒç”¨æ–¹æ³•</p> 
    <el-button @click="sayMessage('å››åäºŒå·æ··å‡åœŸ')">ç‚¹å‡»å¼¹æ¡†</el-button>

    <!-- åœ¨å†…è”äº‹ä»¶å¤„ç†å™¨ä¸­è®¿é—®äº‹ä»¶å‚æ•° -->
    <p>åœ¨å†…è”äº‹ä»¶å¤„ç†å™¨ä¸­è®¿é—®äº‹ä»¶å‚æ•°</p> 
    <!-- ä½¿ç”¨ç‰¹æ®Šçš„ $event å˜é‡ -->
    <el-button @click="warn('Form cannot be submitted yet.', $event)">
      æäº¤1
    </el-button>
    <!-- ä½¿ç”¨å†…è”ç®­å¤´å‡½æ•° -->
    <el-button @click="(event) => warn('Form cannot be submitted yet.', event)">
      æäº¤2
    </el-button>
  </el-card>
  <br/>
  <el-card>
    <template #header>äº‹ä»¶ä¿®é¥°ç¬¦</template>
    <p>stop å•å‡»äº‹ä»¶å°†åœæ­¢ä¼ é€’</p>
    <!-- stopå•å‡»äº‹ä»¶å°†åœæ­¢ä¼ é€’ -->
    <!-- ä¸ä¼šè§¦å‘ -->
    <div style="height:150px;background-color: aliceblue; margin: 10px 0;" @click="parentClicked('parent3', $event)">
      <!-- ä¼šè§¦å‘ -->
      <div style="height:100px;background-color: aquamarine;" @click.stop="parentClicked('parent2', $event)">
        <!-- ä¼šè§¦å‘ -->
        <div style="height:60px;background-color: aqua;" @click="parentClicked('parent1', $event)">
          <el-button @click="handleSelfClick">ç‚¹å‡»æŒ‰é’®</el-button>
          <br/>
          parent1
        </div>
        parent2
      </div>
      parent3
    </div>
    <el-divider/>

    <p>self ä»…å½“ event.target æ˜¯å…ƒç´ æœ¬èº«æ—¶æ‰ä¼šè§¦å‘äº‹ä»¶å¤„ç†å™¨</p>
    <!-- self ä»…å½“ event.target æ˜¯å…ƒç´ æœ¬èº«æ—¶æ‰ä¼šè§¦å‘äº‹ä»¶å¤„ç†å™¨ -->
    <!-- ä¾‹å¦‚ï¼šäº‹ä»¶å¤„ç†å™¨ä¸æ¥è‡ªå­å…ƒç´  -->
    <!-- ä¸ä¼šè§¦å‘ -->
    <div style="height:100px;background-color: aquamarine; margin: 10px 0;" @click="parentClicked('parentwithself', $event)">
      <!-- ä¼šè§¦å‘ -->
      <div  style="height:60px;background-color: aqua;" @click.self="parentClicked('parentwithoutself', $event)">
        <el-button @click="handleSelfClick">ç‚¹å‡»æŒ‰é’®</el-button>
        <br/>
        parentwithoutself
      </div>
      parentwithself
    </div>
    <el-divider/>

    <p>once ç‚¹å‡»æŒ‰é’®åªè§¦å‘ä¸€æ¬¡; prevent ç‚¹å‡»æŒ‰é’®æ—¶é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼› å¯ä»¥é“¾å¼è°ƒç”¨</p>
    <el-tag>ä½¿ç”¨ @click.prevent.self ä¼šé˜»æ­¢å…ƒç´ åŠå…¶å­å…ƒç´ çš„æ‰€æœ‰ç‚¹å‡»äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œè€Œ @click.self.prevent åˆ™åªä¼šé˜»æ­¢å¯¹å…ƒç´ æœ¬èº«çš„ç‚¹å‡»äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºã€‚</el-tag>
    <form @submit.prevent="handleSubmit" style="margin: 10px 0;">
      <el-button @click.stop.once="handleClickOnce">ç‚¹å‡»æˆ‘ï¼ˆä¸€æ¬¡æ€§æŒ‰é’®ï¼‰</el-button>
    </form>

    <el-divider/>

    <!-- æ·»åŠ äº‹ä»¶ç›‘å¬å™¨æ—¶ï¼Œä½¿ç”¨ `capture` æ•è·æ¨¡å¼ -->
    <!-- ä¾‹å¦‚ï¼šæŒ‡å‘å†…éƒ¨å…ƒç´ çš„äº‹ä»¶ï¼Œåœ¨è¢«å†…éƒ¨å…ƒç´ å¤„ç†å‰ï¼Œå…ˆè¢«å¤–éƒ¨å¤„ç† -->
    <p>ä½¿ç”¨ `capture` æ•è·æ¨¡å¼ï¼ŒæŒ‡å‘å†…éƒ¨å…ƒç´ çš„äº‹ä»¶ï¼Œåœ¨è¢«å†…éƒ¨å…ƒç´ å¤„ç†å‰ï¼Œå…ˆè¢«å¤–éƒ¨(parent1)å¤„ç† </p>
    <div style="height:60px;background-color: aqua;margin: 10px 0;" @click.capture="parentClicked('parent1', $event)">
      <el-button @click="handleSelfClick">æ•è·æŒ‰é’®</el-button>
      <br/>
      parent1
    </div>
    <el-divider/>

    <!-- è¢«åŠ¨ç›‘å¬æ»šåŠ¨ï¼ˆä¸ä¼šé˜»æ­¢é»˜è®¤æ»šåŠ¨ï¼‰-->
    <!-- æ»šåŠ¨äº‹ä»¶çš„é»˜è®¤è¡Œä¸º (scrolling) å°†ç«‹å³å‘ç”Ÿè€Œéç­‰å¾… `onScroll` å®Œæˆ -->
    <!-- ä»¥é˜²å…¶ä¸­åŒ…å« `event.preventDefault()` -->
    <p>passive è¢«åŠ¨ç›‘å¬ ä¾‹å¦‚è¢«åŠ¨ç›‘å¬æ»šåŠ¨ï¼ˆä¸ä¼šé˜»æ­¢é»˜è®¤æ»šåŠ¨ï¼‰</p>
    <p>passive ä¿®é¥°ç¬¦ä¸€èˆ¬ç”¨äºè§¦æ‘¸äº‹ä»¶çš„ç›‘å¬å™¨ï¼Œå¯ä»¥ç”¨æ¥æ”¹å–„ç§»åŠ¨ç«¯è®¾å¤‡çš„æ»šå±æ€§èƒ½ã€‚</p>
    <div
      style="height:100px;background-color: aqua;margin: 10px 0;overflow: auto;"
      @wheel.passive="handleScroll"
    >
      <div style="height:200px;">
        <ul>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
          <li>æ»šåŠ¨æˆ‘</li>
        </ul>
      </div>
  </el-card>
  <br/>
  <el-card>
    <template #header>é”®ç›˜äº‹ä»¶</template>
    <el-input
      autosize
      type="textarea"
      v-model="message"
      @keydown.enter.ctrl="submitMessage"
      @keydown.esc="cancelEdit"
      @keydown.tab.prevent="insertTab"
      placeholder="Ctrl + Enter æäº¤ï¼ŒEsc å–æ¶ˆï¼ŒTab æ’å…¥ç¼©è¿›"
    ></el-input>
    <p v-if="submitted">âœ… æäº¤æˆåŠŸï¼š{{ submitted }}</p>
  </el-card>
  <br/>
  <el-card>
    <template #header>é¼ æ ‡äº‹ä»¶</template>
    <!-- å•å‡»äº‹ä»¶ -->
    <p>å•å‡»äº‹ä»¶</p>
    <el-button  @click="handleClick" style="margin:10px 0">å•å‡»æˆ‘</el-button >
    <el-divider></el-divider>
    <!-- åŒå‡»äº‹ä»¶ -->
    <p>åŒå‡»äº‹ä»¶</p>
    <el-button @dblclick="handleDoubleClick" style="margin:10px 0">åŒå‡»æˆ‘</el-button>
    <el-divider></el-divider>
    <!-- æŒ‰ä¸‹å’Œæ¾å¼€ -->
    <div
      class="box"
      @mousedown="handleMouseDown"
      @mouseup="handleMouseUp"
      style="height: 100px; margin:10px 0;background-color: cadetblue;"
    >
      {{ mouseDownUp }}
    </div>
    <el-divider></el-divider>
    <!-- é¼ æ ‡è¿›å…¥å’Œç¦»å¼€ -->
    <div
      class="box"
      @mouseenter="handleMouseEnter"
      @mouseleave="handleMouseLeave"
      style="height: 100px; margin:10px 0;background-color: cadetblue;"
    >
      {{mouseEnterLeave}}
    </div>
    <el-divider></el-divider>
    <!-- é¼ æ ‡ç§»åŠ¨ -->
    <div
      class="box"
      @mousemove="handleMouseMove"
      style="height: 100px; margin:10px 0;background-color: cadetblue;"
    >
      é¼ æ ‡ç§»åŠ¨åŒºåŸŸï¼Œç§»åŠ¨ä½ç½®ï¼šX: {{ mouseX }}, Y: {{ mouseY }}
    </div>
  </el-card>
</template>

<script setup>
import { ref, onMounted } from 'vue';

const count = ref(0)

onMounted(() => {

});

function sayHello(){
  alert("ä½ å®¶äººå¥½å˜›ï¼Ÿ")
}

function sayMessage(message){
  alert(message)
}

function warn(message, event) {
  // è¿™é‡Œå¯ä»¥è®¿é—®åŸç”Ÿäº‹ä»¶
  if (event) {
    // é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œå¦‚è¡¨å•æäº¤é“¾æ¥è·³è½¬
    event.preventDefault()
    alert(`${event.srcElement.innerText} : ${message}`)
  }
  
}

function handleSubmit() {
  alert("è¡¨å•æäº¤è¢«é˜»æ­¢ï¼");
}

function handleClickOnce() {
  alert("ä½ åªä¼šçœ‹åˆ°è¿™ä¸€æ¬¡ï¼");
}

function handleSelfClick() {
  alert("ä½ ç‚¹å‡»æŒ‰é’®ï¼");
}

function parentClicked(from, event) {
  if(event.target !== event.currentTarget){
    alert(`çˆ¶å…ƒç´ ${from} è¢«ç‚¹å‡»ï¼ˆå†’æ³¡ï¼‰`);
  }
  alert(`çˆ¶å…ƒç´ ${from} è¢«ç‚¹å‡»ï¼ˆæœ¬èº«ï¼‰`);
}

function handleScroll() {
  alert("æ»šåŠ¨äº‹ä»¶è§¦å‘");
}

const message = ref('')
const submitted = ref('')

function submitMessage() {
  if (message.value.trim()) {
    submitted.value = message.value
    message.value = ''
  } else {
    alert('å†…å®¹ä¸èƒ½ä¸ºç©º')
  }
}

function cancelEdit() {
  message.value = ''
  alert('ç¼–è¾‘å·²å–æ¶ˆ')
}

function insertTab(event) {
  const textarea = event.target
  const start = textarea.selectionStart
  const end = textarea.selectionEnd
  const value = textarea.value

  // æ’å…¥4ä¸ªç©ºæ ¼
  textarea.value = value.substring(0, start) + '    ' + value.substring(end)
  textarea.selectionStart = textarea.selectionEnd = start + 4

  // æ‰‹åŠ¨è§¦å‘ v-model æ›´æ–°
  message.value = textarea.value
}

const mouseX = ref(0);
const mouseY = ref(0);

const mouseDownUp = ref("æŒ‰ä¸‹æˆ–æ¾å¼€é¼ æ ‡")
const mouseEnterLeave = ref("é¼ æ ‡è¿›å…¥å’Œç¦»å¼€åŒºåŸŸ")

function handleClick(event) {
  alert('å•å‡»äº‹ä»¶è§¦å‘');
}

function handleDoubleClick(event) {
  alert('åŒå‡»äº‹ä»¶è§¦å‘');
}

function handleMouseDown(event) {
  mouseDownUp.value = `é¼ æ ‡æŒ‰ä¸‹`
}

function handleMouseUp(event) {
  mouseDownUp.value = `é¼ æ ‡æ¾å¼€`
}

function handleMouseEnter(event) {
  mouseEnterLeave.value = `é¼ æ ‡è¿›å…¥`
}

function handleMouseLeave(event) {
  mouseEnterLeave.value = `é¼ æ ‡ç¦»å¼€`
}

function handleMouseMove(event) {
  mouseX.value = event.offsetX;
  mouseY.value = event.offsetY;
}
</script>

<style scoped>

</style>
```

### è¡¨å•è¾“å…¥ç»‘å®š

è¡¨å•ç»‘å®šä¸»è¦é€šè¿‡ v-model æŒ‡ä»¤æ¥å®ç°ï¼Œå®ƒå¯ä»¥åŒå‘ç»‘å®šè¾“å…¥æ§ä»¶ä¸ç»„ä»¶çš„æ•°æ®ã€‚

- **åº”ç”¨ç¤ºä¾‹(Vu3)**

``` vue
<template>
  <el-card>
    <template #header>è¡¨å•ç»‘å®š</template>
    <el-form :model="form" label-width="auto" style="max-width: 600px" :rules="rules" ref="formRef">
      <el-form-item label="Activity name" prop="name">
        <el-input v-model.trim="form.name" />
      </el-form-item>
      <el-form-item label="Activity zone" prop="region">
        <el-select v-model="form.region" placeholder="please select your zone">
          <el-option label="Zone one" value="shanghai" />
          <el-option label="Zone two" value="beijing" />
        </el-select>
      </el-form-item>
      <el-form-item label="Number of participants" prop="participants">
        <el-input type="number" min="0" v-model.number="form.participants" />
      </el-form-item>
      <el-form-item label="Activity time">
        <el-col :span="11">
          <el-date-picker
            v-model="form.date1"
            type="date"
            placeholder="Pick a date"
            style="width: 100%"
          />
        </el-col>
        <el-col :span="2" class="text-center">
          <span class="text-gray-500">-</span>
        </el-col>
        <el-col :span="11">
          <el-time-picker
            v-model="form.date2"
            placeholder="Pick a time"
            style="width: 100%"
          />
        </el-col>
      </el-form-item>
      <el-form-item label="Instant delivery">
        <el-switch v-model="form.delivery" />
      </el-form-item>
      <el-form-item label="Activity type">
        <el-checkbox-group v-model="form.type">
          <el-checkbox value="Online activities" name="type">
            Online activities
          </el-checkbox>
          <el-checkbox value="Promotion activities" name="type">
            Promotion activities
          </el-checkbox>
          <el-checkbox value="Offline activities" name="type">
            Offline activities
          </el-checkbox>
          <el-checkbox value="Simple brand exposure" name="type">
            Simple brand exposure
          </el-checkbox>
        </el-checkbox-group>
      </el-form-item>
      <el-form-item label="Resources">
        <el-radio-group v-model="form.resource">
          <el-radio value="Sponsor">Sponsor</el-radio>
          <el-radio value="Venue">Venue</el-radio>
        </el-radio-group>
      </el-form-item>
      <el-form-item label="Activity form">
        <el-input v-model="form.desc" type="textarea" />
      </el-form-item>
      <el-form-item label = "Acceptthe user agreement">
        <el-checkbox v-model="form.accepted" true-value="yes" false-value="no"/>
      </el-form-item>
      <el-form-item>
        <el-button type="primary" @click="onSubmit">Submit</el-button>
        <el-button @click="onReset">Reset</el-button>
      </el-form-item>
    </el-form>

    <el-divider></el-divider>

    <p>æäº¤ç»“æœ</p>
    <p v-if="submitted">{{ form }}</p>
    <p v-else>è¡¨å•æ­£åœ¨è¾“å…¥</p>

  </el-card>
  
</template>

<script lang="ts" setup>
import { ref, reactive, watch } from 'vue'
import { FormInstance, FormRules, ElMessage} from 'element-plus'

//ç”¨äºæ£€éªŒ
const formRef = ref<FormInstance> ()
const form = reactive({
  name: '',
  region: '',
  participants: 0,
  date1: '',
  date2: '',
  delivery: false,
  type: [],
  resource: '',
  desc: '',
  accepted: 'yes'
})

const checkParticipants = (rule: any, value: any, callback: any) => {
  if (!Number.isInteger(value)) {
    callback(new Error('Please input digits'))
  } else{
    if (value > 18) {
      callback(new Error('Participants must be less than 18'))
    } else {
      callback()
    }
  }
}

const rules = reactive<FormRules>({
  name: [
    { required: true, message: 'Please input Activity name', trigger: 'blur' },
    { min: 3, max: 5, message: 'Length should be 3 to 5', trigger: 'blur' },
  ],
  region: [
    { required: true,  message: 'Please select Activity zone', trigger: 'change', }
  ],
  participants: [
    { required: true, validator: checkParticipants,  trigger: 'blur' }
  ],
})


const submitted = ref(false)

const onSubmit = async () => {
  if(!formRef.value) return;
  await formRef.value.validate((valid, fields) => {
    if (valid) { 
      ElMessage({
        message: 'æäº¤æˆåŠŸ.',
        type: 'success',
      })

      submitted.value = true;
      return
    } 
    ElMessage.error('éªŒè¯å¤±è´¥ï¼')
  })
}

const onReset = () => {
  submitted.value = false
  form.name= '',
  form.region= '',
  form.date1= '',
  form.date2= '',
  form.delivery= false,
  form.type= [],
  form.resource=  '',
  form.desc= '',
  form.accepted= 'yes'
}

watch(form, async (newValue, oldValue) => {
  submitted.value = false;
},{ deep: true })

</script>
```

- **ä¿®é¥°ç¬¦**
- `.lazyâ€‹`
é»˜è®¤æƒ…å†µä¸‹ï¼Œv-model ä¼šåœ¨æ¯æ¬¡ input äº‹ä»¶åæ›´æ–°æ•°æ® (IME æ‹¼å­—é˜¶æ®µçš„çŠ¶æ€ä¾‹å¤–)ã€‚ä½ å¯ä»¥æ·»åŠ  lazy ä¿®é¥°ç¬¦æ¥æ”¹ä¸ºåœ¨æ¯æ¬¡ change äº‹ä»¶åæ›´æ–°æ•°æ®ï¼š

``` vue
<!-- åœ¨ "change" äº‹ä»¶ååŒæ­¥æ›´æ–°è€Œä¸æ˜¯ "input" -->
<input v-model.lazy="msg" />
```

- `.numberâ€‹`
å¦‚æœä½ æƒ³è®©ç”¨æˆ·è¾“å…¥è‡ªåŠ¨è½¬æ¢ä¸ºæ•°å­—ï¼Œä½ å¯ä»¥åœ¨ v-model åæ·»åŠ  .number ä¿®é¥°ç¬¦æ¥ç®¡ç†è¾“å…¥ï¼š

``` vue
<input v-model.number="age" />
```
å¦‚æœè¯¥å€¼æ— æ³•è¢« parseFloat() å¤„ç†ï¼Œé‚£ä¹ˆå°†è¿”å›åŸå§‹å€¼ã€‚ç‰¹åˆ«æ˜¯å½“è¾“å…¥ä¸ºç©ºæ—¶ (ä¾‹å¦‚ç”¨æˆ·æ¸…ç©ºè¾“å…¥å­—æ®µä¹‹å)ï¼Œä¼šè¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚è¿™ç§è¡Œä¸ºä¸ DOM å±æ€§ valueAsNumber æœ‰æ‰€ä¸åŒã€‚

number ä¿®é¥°ç¬¦ä¼šåœ¨è¾“å…¥æ¡†æœ‰ type="number" æ—¶è‡ªåŠ¨å¯ç”¨ã€‚

- `.trimâ€‹`
å¦‚æœä½ æƒ³è¦é»˜è®¤è‡ªåŠ¨å»é™¤ç”¨æˆ·è¾“å…¥å†…å®¹ä¸­ä¸¤ç«¯çš„ç©ºæ ¼ï¼Œä½ å¯ä»¥åœ¨ v-model åæ·»åŠ  .trim ä¿®é¥°ç¬¦ï¼š

``` vue
<input v-model.trim="msg" />
```

### ä¾¦å¬å™¨

ä¾¦å¬å™¨ï¼ˆwatcherï¼‰ç”¨äºç›‘å¬å“åº”å¼æ•°æ®çš„å˜åŒ–ï¼Œä»è€Œåœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œç‰¹å®šçš„é€»è¾‘ã€‚

- **åº”ç”¨ç¤ºä¾‹(Vu3)**

``` vue
<template>
  <el-card >
    <template #header>ç›‘å¬æ•°æ®</template>
    
    <el-input-number v-model="num" :min="1" :max="10" />
  </el-card>
  <br/>
  <el-card >
    <template #header>
      ç›‘å¬å¯¹è±¡
    </template>
    <el-tag type="danger" size="large" style="font-size: .8em;font-weight: bold;">onceã€immediateã€deep åœ¨watchæ³¨å†Œæ—¶å·²ç»èµ‹å€¼ï¼Œåˆ‡æ¢æ—¶éœ€è¦ã€å…³é—­ä¾¦å¬ã€‘å†ã€å¼€å¯ä¾¦å¬ã€‘</el-tag>
    <br/>
    <el-tag type="danger" size="large" style="font-size: .8em;font-weight: bold;">ã€å…³é—­ä¾¦å¬ã€‘ï¼šä½¿ç”¨æ³¨å†Œwatchçš„è¿”å›å‡½æ•°</el-tag>
    <br/>
    <div>
       <span>ä¸€æ¬¡å›è°ƒ(once)</span> &nbsp
       <el-checkbox v-model="onceFlag" @change="onceFlagChange($event)"></el-checkbox>
    </div>
    <div>
       <span>ç«‹å³å›è°ƒ</span> &nbsp
       <el-checkbox v-model="immediateFlag" @change="immediateFlagChange($event)"></el-checkbox>
    </div>
    <div>
       <span>æ·±å±‚ä¾¦å¬</span> &nbsp
       <el-checkbox v-model="deepFlag" @change="deepFlagChange($event)"></el-checkbox> &nbsp
       <el-tag type="primary" size="large" style="font-size: .8em;font-weight: bold;">reactiveé»˜è®¤å¼€å¯æ·±åº¦ç›‘å¬ï¼Œæ³¨å†Œæ—¶æœªèµ‹å€¼ï¼Œä½¿ç”¨é»˜è®¤å€¼ï¼Œä»¥å¯¹æ¯”å±•ç¤º</el-tag>
    </div>
    <el-divider></el-divider>

    <div>
      <span>ç›‘å¬refå¯¹è±¡</span> &nbsp
      <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">ref é»˜è®¤ä¸ä¼šæ·±åº¦ç›‘å¬ï¼Œéœ€è¦æ‰‹åŠ¨ä½¿ç”¨ deep:true</el-tag>
    </div>

    <ul>
      <li v-for="(value, key) in personRef" :key="key">
        <template v-if="getType(value) === 'Object'">
          {{ key }}:
          <ul>
            <li v-for="(v, k) in value" :key="key">{{ k }}: {{ v }}</li>
          </ul>
        </template>
        <template v-else>
          {{ key }}: {{ value }}
        </template>
      </li>
    </ul>
    <el-button @click="generatePersonRef">éšæœºç”Ÿæˆäººå‘˜ä¿¡æ¯</el-button>
    <el-button @click="updatePersonFullNameRef">éšæœºä¿®æ”¹äººå‘˜ä¿¡æ¯</el-button>

    <el-divider></el-divider>

    <div>
      <span>ç›‘å¬reactiveå¯¹è±¡ </span> &nbsp
      <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">reactive æ›¿æ¢å¯¹è±¡å®ä¾‹åå¤±å»å“åº”æ€§ï¼›ä½†é»˜è®¤å¼€å¯æ·±åº¦ç›‘å¬</el-tag>
    </div>
    
    <ul>
      <li v-for="(value, key) in personReactive" :key="key">
        <template v-if="getType(value) === 'Object'">
          {{ key }}:
          <ul>
            <li v-for="(v, k) in value" :key="key">{{ k }}: {{ v }}</li>
          </ul>
        </template>
        <template v-else>
          {{ key }}: {{ value }}
        </template>
      </li>
    </ul>
    <el-button @click="generatePersonReactive">éšæœºç”Ÿæˆäººå‘˜ä¿¡æ¯</el-button>
    <el-button @click="updatePersonFullNameReactive">éšæœºä¿®æ”¹äººå‘˜ä¿¡æ¯</el-button>
  </el-card>

  <br/>
  <el-card>
    <template #header>watchEffect</template>
    
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">åªä¼šç›‘å¬æ–¹æ³•ä¸­è°ƒç”¨çš„å±æ€§</el-tag>
    <br/>
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">ç›¸å¯¹äºwatchï¼Œåœ¨ watchEffect å†…æ”¹å˜å…¶æ­£åœ¨ç›‘å¬çš„å˜é‡æ—¶ï¼Œä¸ä¼šå¯¼è‡´æ— é™é€’å½’æˆ–å¾ªç¯è°ƒç”¨ã€‚</el-tag>
    <br/>
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">é»˜è®¤å¼€å¯immediateã€deep</el-tag>
    <br/>
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">
      æœªé¿å…ä¸‹æ¬¡ç›‘å¬æ”¹å˜æ—¶ keyword å‘ç”Ÿäº†å˜åŒ–ï¼Œä½¿ç”¨onWatcherCleanupã€vue 3.5+ã€‘å–æ¶ˆä¸Šæ¬¡è¯·æ±‚ã€‚ä¸èƒ½åœ¨å¼‚æ­¥å‡½æ•°çš„ await è¯­å¥ä¹‹åè°ƒç”¨å®ƒ
    </el-tag>
    <br/>
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;"><
      onCleanup å‡½æ•°è¿˜å¯ä»¥ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™ä¾¦å¬å™¨å›è°ƒï¼Œä»¥åŠ watchEffect ä½œç”¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚
    </el-tag>
    <br/>
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">é»˜è®¤å¼‚æ­¥æ‰¹é‡è§¦å‘</el-tag>
    <br/>
    <el-input v-model.trim="keyword" placeholder="è¾“å…¥å…³é”®è¯â€¦" />
    <p v-if="loading">åŠ è½½ä¸­...</p>
    <ul v-else>
      <li v-for="item in results" :key="item.id">{{ item.title }}</li>
    </ul>
  </el-card>

</template>

<script setup>
import { ElMessage } from 'element-plus';
import { fa, fakerZH_CN as faker } from '@faker-js/faker' 
import { getType } from '@/common'
import { ref, reactive, computed, onMounted, watch, watchEffect, toRef } from 'vue';
import { useWatchStore } from'@/store'

/**
 * watch
 */
const store = useWatchStore()

onMounted(() => {
  startWatchRef()
  startWatchReactive()
});

//ç›‘å¬æ•°æ®
const num = ref(1)

watch(num, async (newValue, oldValue) => {
  ElMessage.success(`newValue: ${newValue}, oldValue: ${oldValue}`)
})

const generatePersonData = () => {
  return {
    fullName: faker.person.fullName(),
    address: {
      country: faker.location.country(),
      city: faker.location.city(),
      street: faker.location.streetAddress(),
      zipCode: faker.location.zipCode(),
    },
  }
}

const onceFlag = ref(store.onceFlag)

const onceFlagChange = (value) => {
  store.$patch((state) => {
    state.onceFlag = value
  })
  stopWatchRef()
  startWatchRef()
  stopWatchReactive()
  startWatchReactive()
}

const immediateFlag = ref(store.immediateFlag)

const immediateFlagChange = (value) => {
  store.$patch((state) => {
    state.immediateFlag = value
  })
  stopWatchRef()
  startWatchRef()
  stopWatchReactive()
  startWatchReactive()
}

const deepFlag = ref(store.deepFlag)

const deepFlagChange = (value) => {
  store.$patch((state) => {
    state.deepFlag = value
  })
  stopWatchRef()
  startWatchRef()
  stopWatchReactive()
  startWatchReactive()
}

//ç›‘å¬å¯¹è±¡
//ref
const personRef = ref(generatePersonData())

const generatePersonRef = () => {
  personRef.value = generatePersonData()
}

const updatePersonFullNameRef = () => {
  personRef.value.fullName = faker.person.fullName()
  personRef.value.address.city = faker.location.city()
}

let stopWatchRefTemp = null

const startWatchRef = () => {
  if(stopWatchRefTemp) 
    return
  stopWatchRefTemp = watch(personRef, 
    async (newValue, oldValue) => 
    {
      ElMessage.success(`ref watch: [newValue: ${newValue.fullName}, oldValue: ${oldValue ? oldValue.fullName : ""}]`)
    }, 
    {
      deep: deepFlag.value,
      once: onceFlag.value,
      immediate: immediateFlag.value
    }
  )
}

const stopWatchRef = () => {
  //è°ƒç”¨è¿”å›å‡½æ•°
  stopWatchRefTemp()
  //æ¸…ç©ºä»¥ä¾¿ä¸‹æ¬¡èµ‹å€¼
  stopWatchRefTemp = null
}

//ç›‘å¬å¯¹è±¡
//reactive
let personReactive = reactive(generatePersonData())

const generatePersonReactive = () => {
  //å¤±å»å“åº”æ€§
  // personReactive = generatePersonData()
  //éå†èµ‹å€¼ä¸ä¼šå¤±å»å“åº”æ€§
  let person = generatePersonData()
  for(let key in person){
    personReactive[key] = person[key]
  }
}

const updatePersonFullNameReactive = () => {
  personReactive.fullName = faker.person.fullName()
  personReactive.address.city = faker.location.city()
}

let stopWatchReactiveTemp = null

const startWatchReactive = () => {
  if(stopWatchReactiveTemp) 
    return
  stopWatchReactiveTemp = watch(personReactive, 
    async (newValue, oldValue) => 
    {
      ElMessage.success(`reactive watch: [newValue: ${newValue.fullName}, oldValue: ${oldValue ? oldValue.fullName : ""}]`)
    },
    {
      once: onceFlag.value,
      immediate: immediateFlag.value
    }
  )
}

const stopWatchReactive = () => {
  //è°ƒç”¨è¿”å›å‡½æ•°
  stopWatchReactiveTemp()
  //æ¸…ç©ºä»¥ä¾¿ä¸‹æ¬¡èµ‹å€¼
  stopWatchReactiveTemp = null
}

/**
 * watchEffect 
 */
const loading = ref(false)
const keyword = ref('')
//æ­£åœ¨è¯·æ±‚çš„Keyword
const requestingKeyword = ref('')
const results = ref([])

watchEffect((onInvalidate) => {
    if (!keyword.value) {
      results.value = []
      return
    }

    loading.value = true
    //ç›¸å¯¹äºwatchï¼Œè™½ç„¶ç›‘å¬ä½†ä¸ä¼šæ— é™é€’å½’
    requestingKeyword.value = keyword.value
    ElMessage.primary(`æ­£åœ¨è¯·æ±‚, keyword: ${keyword.value}`)
    let canceled = false

    // æœªé¿å…ä¸‹æ¬¡ç›‘å¬æ”¹å˜æ—¶ keyword å‘ç”Ÿäº†å˜åŒ–
    // æ¯æ¬¡ keyword æ”¹å˜æ—¶å–æ¶ˆä¹‹å‰çš„â€œè¯·æ±‚â€
    onInvalidate(() => {
      if(loading.value){
        ElMessage.error(`å–æ¶ˆè¯·æ±‚, keyword: ${requestingKeyword.value}`)
        canceled = true
      }
    })

    // æ¨¡æ‹Ÿ API å¼‚æ­¥å»¶æ—¶å»¶è¿Ÿ
    setTimeout(() => {
      if (!canceled) {
        // ä½¿ç”¨ faker ç”Ÿæˆ 5 æ¡å‡æ•°æ®
        results.value = Array.from({ length: Math.floor(Math.random() * 10) + 1 }, () => ({
          id: faker.string.uuid(),
          title: faker.word.words({ count: Math.floor(Math.random() * 10) + 1 })
        }))
        loading.value = false
        ElMessage.success(`è¯·æ±‚æˆåŠŸ, keyword: ${keyword.value}`)
      }
    }, 1000 * (Math.floor(Math.random() * 10) + 1))
  })

</script>

<style scoped>

</style>
```

- **æ³¨æ„äº‹é¡¹**

::: warning **watch** 

**æ³¨å†Œæ—¶å…¶ä»–å±æ€§ï¼š**

- **ä¸€æ¬¡å›è°ƒ(once)**   
- **ç«‹å³å›è°ƒ(immediate)**  
- **æ·±å±‚ä¾¦å¬(deep)** 

> onceã€immediateã€deep åœ¨watchæ³¨å†Œæ—¶èµ‹å€¼

---

**ç›‘å¬refå¯¹è±¡**

- **ref é»˜è®¤ä¸ä¼šæ·±åº¦ç›‘å¬ï¼Œéœ€è¦æ‰‹åŠ¨ä½¿ç”¨ deep:true**

---

**ç›‘å¬reactiveå¯¹è±¡**

- **é»˜è®¤å¼€å¯æ·±åº¦ç›‘å¬**
- **æ³¨æ„æ›´æ–°æ—¶ä¸è¦æ›¿æ¢å¯¹è±¡ã€æ•°ç»„ã€‚ä¼šä¸§å¤±å“åº”æ€§**

:::

::: warning **watchEffect** 

1. **åªä¼šç›‘å¬æ–¹æ³•ä¸­è°ƒç”¨çš„å±æ€§**
2. **ç›¸å¯¹äºwatchï¼Œåœ¨ watchEffect å†…æ”¹å˜å…¶æ­£åœ¨ç›‘å¬çš„å˜é‡æ—¶ï¼Œä¸ä¼šå¯¼è‡´æ— é™é€’å½’æˆ–å¾ªç¯è°ƒç”¨ã€‚**
3. **é»˜è®¤å¼€å¯immediateã€deep**
4. **æœªé¿å…ä¸‹æ¬¡ç›‘å¬æ”¹å˜æ—¶ keyword å‘ç”Ÿäº†å˜åŒ–ï¼Œä½¿ç”¨onWatcherCleanupã€vue 3.5+ã€‘å–æ¶ˆä¸Šæ¬¡è¯·æ±‚ã€‚ä¸èƒ½åœ¨å¼‚æ­¥å‡½æ•°çš„ await è¯­å¥ä¹‹åè°ƒç”¨å®ƒ**
5. **onCleanup å‡½æ•°è¿˜å¯ä»¥ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™ä¾¦å¬å™¨å›è°ƒï¼Œä»¥åŠ watchEffect ä½œç”¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚**
6. **é»˜è®¤å¼‚æ­¥æ‰¹é‡è§¦å‘**

:::

### æ¨¡æ¿å¼•ç”¨

æ¨¡æ¿å¼•ç”¨ï¼ˆTemplate Refsï¼‰ æ˜¯ä¸€ç§è·å– DOM å…ƒç´ æˆ–å­ç»„ä»¶å®ä¾‹çš„æ–¹å¼ï¼Œå¸¸ç”¨äºéœ€è¦ç›´æ¥æ“ä½œ DOM æˆ–è°ƒç”¨å­ç»„ä»¶æ–¹æ³•çš„åœºæ™¯ã€‚

- **åº”ç”¨ç¤ºä¾‹(Vu3)**

``` vue
<template>
  <el-card >
    <template #header>å…ƒç´ ä¸Šçš„ ref</template>
    
    <input style="margin-bottom: 10px;" ref="myInput" />
    <br>
    <el-button type="primary" @click="focusInput">èšç„¦input</el-button>
  </el-card>
  <br/>
  <el-card >
    <template #header>ç»„ä»¶çš„ ref</template>
    
    <!-- HTML å±æ€§é»˜è®¤ä¼ å…¥çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹, ç‰¹åˆ«æ³¨æ„ä½¿ç”¨ :ï¼ˆå³ v-bindï¼‰ç»‘å®šï¼Œå¦åˆ™å°±æ˜¯å­—ç¬¦ä¸²ã€‚ -->
    <ChildComponent :id = "1" title="å­ç»„ä»¶" ref="childRef" />
    <el-button type="primary" @click="callChildSayHollow">è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</el-button>
  </el-card>
  <br/>
  <el-card >
    <template #header>v-for ä¸­çš„æ¨¡æ¿å¼•ç”¨</template>
    
    <el-tag type="danger" size="large" style="font-size: .8em;font-weight: bold;">éœ€è¦v3.5 åŠä»¥ä¸Šç‰ˆæœ¬</el-tag>
    <ul>
      <li v-for="item in list" ref="itemRefs">
        {{ item }}
      </li>
    </ul>
    <el-button type="primary" @click="callItemRefs">æ˜¾ç¤ºå¼•ç”¨</el-button>
  </el-card>
  <br/>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue';
import ChildComponent from '@/components/ChildComponent.vue'
import { ElMessage } from 'element-plus';
import { fakerZH_CN as faker } from '@faker-js/faker' 

onMounted(() => {
 
});

const myInput = ref(null)

const focusInput = () => {
   myInput.value.focus()  // ç›´æ¥æ“ä½œ DOM
}

const childRef = ref(null)

const callChildSayHollow = () => {
   ElMessage.primary(childRef.value.sayHello()) 
}

const list = ref(Array.from({ length: Math.floor(Math.random() * 10) + 1 }, () => ({
  item: faker.word.words({ count: Math.floor(Math.random() * 10) + 1 })
})))
const itemRefs = ref([])

const callItemRefs = () => {
  console.log(itemRefs.value)
  itemRefs.value.forEach((item, index) => {
      ElMessage({
        message: item.innerHTML, 
        type: 'primary' 
      })
  })
}

</script>

<style scoped>

</style>

```

## ç»„ä»¶

`Vue` ç»„ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¸¦æœ‰**æ¨¡æ¿**ï¼ˆ`HTML`ï¼‰ã€**é€»è¾‘**ï¼ˆ`JavaScript`ï¼‰å’Œ**æ ·å¼**ï¼ˆ`CSS`ï¼‰çš„**å°è£…ä½“**ï¼Œå¸®åŠ©æˆ‘ä»¬æ„å»º**æ¨¡å—åŒ–**ã€**æ˜“ç»´æŠ¤**çš„å‰ç«¯åº”ç”¨ã€‚

### åŸºæœ¬ç”¨æ³•

- **å®šä¹‰ç»„ä»¶çš„æ–¹å¼**
  1. **å°† Vue ç»„ä»¶å®šä¹‰åœ¨ä¸€ä¸ªå•ç‹¬çš„ .vue æ–‡ä»¶ä¸­ï¼Œè¿™è¢«å«åšå•æ–‡ä»¶ç»„ä»¶ (Single-File Component ç®€ç§° SFC)ï¼š**

  SFCBasicComponent.vue:

  ``` vue
  <template>
      <el-button @click="count++">You clicked me {{ count }} times.</el-button>
  </template>

  <script setup>
  import { ref } from 'vue'

  const count = ref(0)

  </script>

  <style scoped>

  </style>
  ```

  2. **ä»¥ä¸€ä¸ªåŒ…å« Vue ç‰¹å®šé€‰é¡¹çš„ JavaScript å¯¹è±¡æ¥å®šä¹‰**

  JsComponent.js

  ``` javascript
  import { ref } from 'vue'

  export default {
    setup() {
      const count = ref(0)
      return { count }
    },
    template: `
      <el-button @click="count++">
        You clicked me {{ count }} times.
      <el-/button>`
    // ä¹Ÿå¯ä»¥é’ˆå¯¹ä¸€ä¸ª DOM å†…è”æ¨¡æ¿ï¼š
    // template: '#my-template-element'
  }
  ```

  ::: warning æ³¨æ„
  ä½¿ç”¨ template é€‰é¡¹è¿›è¡Œç»„ä»¶å®šä¹‰ï¼ˆå¦‚åŠ¨æ€æ³¨å†Œç»„ä»¶æˆ–ä¸ä½¿ç”¨å•æ–‡ä»¶ .vue æ¨¡æ¿æ—¶ï¼‰ï¼Œéœ€è¦ä½¿ç”¨å®Œæ•´ç‰ˆï¼ˆå¸¦ç¼–è¯‘å™¨ï¼‰**çš„ Vueã€‚

  éœ€è¦ç¼–è¾‘ vite.config.jsï¼š

  ``` javascript
  alias: {
      vue: 'vue/dist/vue.esm-bundler.js' //æ·»åŠ 
  }
  ```

  :::

- **æ³¨å†Œç»„ä»¶çš„æ–¹å¼**
  1. **å±€éƒ¨æ³¨å†Œï¼šç»„åˆå¼ APIå¯¼å…¥åç›´æ¥ä½¿ç”¨ï¼›é€‰é¡¹å¼ API ä½¿ç”¨ components é€‰é¡¹æ¥æ˜¾å¼æ³¨å†Œ**
  2. **å…¨å±€æ³¨å†Œï¼šä½¿ç”¨ Vue åº”ç”¨å®ä¾‹çš„ .component() æ–¹æ³•ï¼Œè®©ç»„ä»¶åœ¨å½“å‰ Vue åº”ç”¨ä¸­å…¨å±€å¯ç”¨**
  
  ``` vue
    <template>
      <el-card >
        <template #header>SFCå•ç»„ä»¶</template>
        
        <SFCBasicComponent></SFCBasicComponent>
        <SFCBasicComponent></SFCBasicComponent>
        <SFCBasicComponent></SFCBasicComponent>
      </el-card>
      <br/>
      <el-card >
        <template #header>Jså¯¹è±¡å®šä¹‰ç»„ä»¶</template>
        
        <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">éœ€è¦åœ¨ vite.config.js æ·»åŠ  alias- vue: 'vue/dist/vue.esm-bundler.js'  </el-tag>
        <br/>
        <JsComponent></JsComponent>
        <JsComponent></JsComponent>
        <JsComponent></JsComponent>
      </el-card>
      <br/>
      <el-card >
        <template #header>å…¨å±€æ³¨å†Œç»„ä»¶</template>
        
        <ScGlobalComponent></ScGlobalComponent>
      </el-card>
    </template>

    <script setup>
    import { ref, computed, onMounted } from 'vue';
    import SFCBasicComponent from '@/components/SFCBasicComponent.vue'
    import JsComponent from '@/components/JsComponent.js'

    const props = defineProps();

    const emits = defineEmits();

    onMounted(() => {

    });

    </script>

    <style scoped>

    </style>

  ```

---

### ç”Ÿå‘½å‘¨æœŸ

![](pictures/vuelifecycle.png)

ç¤ºä¾‹å‚è€ƒã€åŸºæœ¬ç”¨æ³•ã€‘

---

### å±æ€§

**å±æ€§ï¼ˆpropsï¼‰æ˜¯çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶çš„æ•°æ®æ¥å£**ï¼Œå­ç»„ä»¶é€šè¿‡ props æ¥æ”¶è¿™äº›æ•°æ®ï¼Œå¹¶å¯ä»¥åœ¨æ¨¡æ¿æˆ–é€»è¾‘ä¸­ä½¿ç”¨ã€‚

::: warning ç»„ä»¶å±æ€§ç‰¹ç‚¹

- å±æ€§æ˜¯çˆ¶ç»„ä»¶ä¼ æ•°æ®ç»™å­ç»„ä»¶çš„å”¯ä¸€æ–¹å¼
- æ ¡éªŒæ–¹å¼ï¼šç±»å‹å¼ºæ ¡éªŒ + é»˜è®¤å€¼ + è‡ªå®šä¹‰éªŒè¯
- **åªè¯»**ã€**å•å‘ç»‘å®š**ï¼Œå­ç»„ä»¶ä¸åº”ä¿®æ”¹ props
- **Boolean ç±»å‹è½¬æ¢**: `booleanProp` ç›¸å½“äº `:booleanProp = 'true'`
:::

- **ç»„ä»¶å±æ€§ç¤ºä¾‹**

PropsDemoComponent.vue

``` vue
<template>
  <p>String: </p>
  <p>{{ stringProp }}</p>
  <el-divider></el-divider>
  <p>Number </p>
  <p>{{ numberProp }}</p>
  <el-divider></el-divider>
  <p>Boolean </p>
  <p>{{ booleanProp }}</p>
  <el-divider></el-divider>
  <p>Array </p>
  <p>{{ arrayProp }}</p>
  <el-divider></el-divider>
  <p>Object </p>
  <p>{{ objectProp }}</p>
</template>

<script setup>
import { ElMessage } from 'element-plus';
import { watchEffect } from 'vue';

const props = defineProps({
  stringProp: String,
  numberProp: Number,
  booleanProp: Boolean,
  arrayProp: Array,
  objectProp: Object
})

watchEffect(() => {
  // åœ¨ 3.5 ä¹‹å‰åªè¿è¡Œä¸€æ¬¡
  // åœ¨ 3.5+ ä¸­åœ¨ "foo" prop å˜åŒ–æ—¶é‡æ–°æ‰§è¡Œ
  ElMessage.warning(props.stringProp)
})

function updateProps() {
  //å•å‘æ•°æ®æµ ä¼šæŠ¥é”™
  props.stringProp = "child updated"
}

defineExpose({ updateProps })

</script>

<style scoped></style>
```

:::  warning Prop æ ¡éªŒ

- æ‰€æœ‰ prop é»˜è®¤éƒ½æ˜¯å¯é€‰çš„ï¼Œé™¤éå£°æ˜äº† required: trueã€‚
- é™¤ Boolean å¤–çš„æœªä¼ é€’çš„å¯é€‰ prop å°†ä¼šæœ‰ä¸€ä¸ªé»˜è®¤å€¼ undefinedã€‚
- å¦‚æœå£°æ˜äº† default å€¼ï¼Œé‚£ä¹ˆåœ¨ prop çš„å€¼è¢«è§£æä¸º undefined æ—¶ï¼Œæ— è®º prop æ˜¯æœªè¢«ä¼ é€’è¿˜æ˜¯æ˜¾å¼æŒ‡æ˜çš„ undefinedï¼Œéƒ½ä¼šæ”¹ä¸º default å€¼ã€‚
- å½“ prop çš„æ ¡éªŒå¤±è´¥åï¼ŒVue ä¼šæŠ›å‡ºä¸€ä¸ªæ§åˆ¶å°è­¦å‘Š (åœ¨å¼€å‘æ¨¡å¼ä¸‹)ã€‚
:::

- **ç»„ä»¶å±æ€§æ ¡éªŒç¤ºä¾‹**

PropsValidatorComponent.vue

``` vue
<template>
  <p>propA </p>
  <p>{{ propA }}</p>
  <el-divider></el-divider>
  <p>propB </p>
  <p>{{ propB }}</p>
  <el-divider></el-divider>
  <p>propC </p>
  <p>{{ propC }}</p>
  <el-divider></el-divider>
  <p>propD </p>
  <p>{{ propD }}</p>
  <el-divider></el-divider>
  <p>propE </p>
  <p>{{ propE }}</p>
  <el-divider></el-divider>
  <p>propF </p>
  <p>{{ propF }}</p>
  <el-divider></el-divider>
  <p>propG </p>
  <p>{{ propG }}</p>
  <el-divider></el-divider>
  <p>propH </p>
  <p>{{ propH }}</p>
</template>

<script setup>

const props = defineProps({
  // åŸºç¡€ç±»å‹æ£€æŸ¥
  // ï¼ˆç»™å‡º `null` å’Œ `undefined` å€¼åˆ™ä¼šè·³è¿‡ä»»ä½•ç±»å‹æ£€æŸ¥ï¼‰
  propA: Number,
  // å¤šç§å¯èƒ½çš„ç±»å‹
  propB: [String, Number],
  // å¿…ä¼ ï¼Œä¸”ä¸º String ç±»å‹
  propC: {
    type: String,
    required: true
  },
  // å¿…ä¼ ä½†å¯ä¸º null çš„å­—ç¬¦ä¸²
  propD: {
    type: [String, null],
    required: true
  },
  // Number ç±»å‹çš„é»˜è®¤å€¼
  propE: {
    type: Number,
    default: 100
  },
  // å¯¹è±¡ç±»å‹çš„é»˜è®¤å€¼
  propF: {
    type: Object,
    // å¯¹è±¡æˆ–æ•°ç»„çš„é»˜è®¤å€¼
    // å¿…é¡»ä»ä¸€ä¸ªå·¥å‚å‡½æ•°è¿”å›ã€‚
    // è¯¥å‡½æ•°æ¥æ”¶ç»„ä»¶æ‰€æ¥æ”¶åˆ°çš„åŸå§‹ prop ä½œä¸ºå‚æ•°ã€‚
    default(rawProps) {
      return { message: 'hello' }
    }
  },
  // è‡ªå®šä¹‰ç±»å‹æ ¡éªŒå‡½æ•°
  // åœ¨ 3.4+ ä¸­å®Œæ•´çš„ props ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥
  propG: {
    validator(value, props) {
      // The value must match one of these strings
      return ['success', 'warning', 'danger'].includes(value)
    }
  },
  // å‡½æ•°ç±»å‹çš„é»˜è®¤å€¼
  propH: {
    type: Function,
    // ä¸åƒå¯¹è±¡æˆ–æ•°ç»„çš„é»˜è®¤ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ª
    // å·¥å‚å‡½æ•°ã€‚è¿™ä¼šæ˜¯ä¸€ä¸ªç”¨æ¥ä½œä¸ºé»˜è®¤å€¼çš„å‡½æ•°
    default() {
      return 'Default function'
    }
  }
})

</script>

<style scoped></style>
```

### Attributes é€ä¼ 

`Attributes` é€ä¼ ï¼ˆ`Fallthrough Attributes`ï¼‰ æ˜¯æŒ‡æœªåœ¨ç»„ä»¶ `props` æˆ– `emits` ä¸­å£°æ˜çš„å±æ€§ï¼ˆå¦‚ `class`ã€`style`ã€åŸç”Ÿ DOM äº‹ä»¶ç­‰ï¼‰ï¼Œä¼šè‡ªåŠ¨â€œç©¿é€â€åˆ°ç»„ä»¶æ ¹èŠ‚ç‚¹ã€‚

::: warning å•å±‚é€ä¼ 
- **å¤šæ ¹èŠ‚ç‚¹ï¼Œæˆ–è€…å¤–å±‚åŒ…è£¹`div`æ—¶ï¼Œéœ€è¦ä½¿ç”¨ `v-bind="$attrs"` æŒ‡å®šé€ä¼ ç›®æ ‡å…ƒç´ ã€‚æœªå£°æ˜çš„å±æ€§é€ä¼ è‡³æ ¹å…ƒç´ ã€‚**
- **`class`ã€`style` ä¼šåˆå¹¶**
- **åŸç”Ÿäº‹ä»¶ç›‘å¬å™¨ä¹Ÿä¼šé€ä¼ **
- **å¯ä»¥ä½¿ç”¨ `defineOptions({ inheritAttrs: false })` é˜»æ­¢é€ä¼ **

ç¤ºä¾‹ï¼š

AttributeDemoComponent.vue

``` vue
<!-- MyInput.vue -->
<template>
  <div class="field">
    <el-button type="primary" class="inner-input" v-bind="$attrs" @click="onClick">{{ label }}</el-button>
  </div>
</template>

<script setup>
// defineOptions({ inheritAttrs: false })
defineProps(['label'])
import { ElMessage } from 'element-plus'
import { useAttrs } from 'vue'

const attrs = useAttrs()


const onClick = () => {
  ElMessage.info({
    duration: 30000,
    showClose: true,
    message: `å­ç»„ä»¶è§¦å‘`
  })
  for (let key in attrs) {
    ElMessage.warning({
      duration: 30000,
      showClose: true,
      message: `å±æ€§ï¼š${key}  ${attrs[key]} å·²é€ä¼ `
    })
  }
}
</script>

<style>
.field {
  padding: 4px;
}

.inner-input {
  width: 100%;
}
</style>

```

:::



::: warning åµŒå¥—é€ä¼ 
- **å£°æ˜è¿‡çš„ props å’Œä¾¦å¬å‡½æ•°ä¸å†é€ä¼ ï¼Œå…¶ä»–å…¨éƒ¨é€ä¼ **

ç¤ºä¾‹ï¼š

AttributeNestedDemoComponent.vue

``` vue
<!-- MyInput.vue -->
<template>
  <AttributeDemoComponent @click="onClick" />
</template>

<script setup>
import AttributeDemoComponent from './AttributeDemoComponent.vue';
import { ElMessage } from 'element-plus'
import { useAttrs, defineProps } from 'vue'
const props = defineProps({
  nestedAttr: String,
});
const attrs = useAttrs()
const onClick = () => {
  ElMessage.primary({
    duration: 30000,
    showClose: true,
    message: `ä¸­é—´ç»„ä»¶ç»„ä»¶è§¦å‘, nestedAttr:${props.nestedAttr}å·²æ¶ˆè´¹`
  })
  for (let key in attrs) {
    ElMessage.error({
      duration: 30000,
      showClose: true,
      message: `å±æ€§ï¼š${key}  ${attrs[key]} å·²é€ä¼ `
    })
  }
}
</script>

<style scoped></style>

```

::: 

- **è°ƒç”¨ç¤ºä¾‹ï¼š**

``` vue
<template>
  <el-card>
    <template #header>Attribute é€ä¼ </template>

    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">å¤šæ ¹èŠ‚ç‚¹ï¼Œæˆ–è€…å¤–å±‚åŒ…è£¹divæ—¶ï¼Œéœ€è¦ä½¿ç”¨ v-bind="$attrs"
      æŒ‡å®šé€ä¼ ç›®æ ‡å…ƒç´ ã€‚æœªå£°æ˜çš„å±æ€§é€ä¼ è‡³æ ¹å…ƒç´ ã€‚ </el-tag>
    <br />
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">classã€style ä¼šåˆå¹¶ </el-tag>
    <br />
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">åŸç”Ÿäº‹ä»¶ç›‘å¬å™¨ä¹Ÿä¼šé€ä¼  </el-tag>
    <br />
    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">å¯ä»¥ä½¿ç”¨ defineOptions({ inheritAttrs:
      false })
      é˜»æ­¢é€ä¼ </el-tag>
    <br />
    <AttributeDemoComponent id="sc-button" class="custom-input" @click="onClick" label="ç‚¹æˆ‘" nestedAttr='åµŒå¥—å±æ€§' />
  </el-card>
  <br />
  <el-card>
    <template #header>æ·±å±‚ç»„ä»¶ç»§æ‰¿</template>

    <el-tag type="warning" size="large" style="font-size: .8em;font-weight: bold;">å£°æ˜è¿‡çš„ props å’Œä¾¦å¬å‡½æ•°ä¸å†é€ä¼ ï¼Œå…¶ä»–å¯ä»¥é€ä¼  </el-tag>
    <br />
    <AttributeNestedDemoComponent id="sc-button" class="custom-input" @click="onClick" label="ç‚¹æˆ‘" nestedAttr='åµŒå¥—å±æ€§' />
  </el-card>
</template>

<script setup>
import AttributeDemoComponent from '@/components/AttributeDemoComponent.vue';
import AttributeNestedDemoComponent from '@/components/AttributeNestedDemoComponent.vue';
import { ElMessage } from 'element-plus'


const onClick = () => {
  ElMessage.info({ duration: 30000, showClose: true, message: `çˆ¶ç»„ä»¶è§¦å‘` })
}

</script>

<style scoped></style>
```

### äº‹ä»¶

### v-model

### æ’æ§½

### ä¾èµ–æ³¨å…¥

### å¼‚æ­¥ç»„ä»¶


## é€»è¾‘å¤ç”¨

## åº”ç”¨è§„æ¨¡åŒ–

## vuex

## vue-router

## Element-UI

## httpè¯·æ±‚